(function(e){function t(t){for(var c,r,s=t[0],l=t[1],i=t[2],d=0,p=[];d<s.length;d++)r=s[d],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&p.push(a[r][0]),a[r]=0;for(c in l)Object.prototype.hasOwnProperty.call(l,c)&&(e[c]=l[c]);u&&u(t);while(p.length)p.shift()();return o.push.apply(o,i||[]),n()}function n(){for(var e,t=0;t<o.length;t++){for(var n=o[t],c=!0,s=1;s<n.length;s++){var l=n[s];0!==a[l]&&(c=!1)}c&&(o.splice(t--,1),e=r(r.s=n[0]))}return e}var c={},a={app:0},o=[];function r(t){if(c[t])return c[t].exports;var n=c[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=c,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var c in e)r.d(n,c,function(t){return e[t]}.bind(null,c));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var i=0;i<s.length;i++)t(s[i]);var u=l;o.push([0,"vendor.moment","vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"04ce":function(e,t,n){"use strict";n("af4b")},"0db0":function(e,t,n){},"0f70":function(e,t,n){},1:function(e,t){},10:function(e,t){},11:function(e,t){},"112d":function(e,t,n){},"13f1":function(e,t,n){"use strict";n("9ddc")},"17df":function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALkAAAA1CAYAAAAd30r/AAABhWlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AYht+mij9UOthBxCFD1cWCqIijVqEIFUKt0KqDyaV/0KQhSXFxFFwLDv4sVh1cnHV1cBUEwR8QNzcnRRcp8buk0CLGO457eO97X+6+A4R6mWlWxzig6baZSsTFTHZV7HpFEGH00ByVmWXMSVISvuPrHgG+38V4ln/dn6NPzVkMCIjEs8wwbeIN4ulN2+C8TxxhRVklPiceM+mCxI9cVzx+41xwWeCZETOdmieOEIuFNlbamBVNjXiKOKpqOuULGY9VzluctXKVNe/JXxjK6SvLXKc1hAQWsQQJIhRUUUIZNmK066RYSNF53Mc/6PolcinkKoGRYwEVaJBdP/gf/O6tlZ+c8JJCcaDzxXE+hoGuXaBRc5zvY8dpnADBZ+BKb/krdWDmk/RaS4seAeFt4OK6pSl7wOUOMPBkyKbsSkFaQj4PvJ/RN2WB/lugd83rW/Mcpw9AmnqVvAEODoGRAmWv+7y7u71v/9Y0+/cDJ+1yiSGGfWsAAAAGYktHRAAAAAAAAPlDu38AAAAJcEhZcwAADdcAAA3XAUIom3gAAAAHdElNRQflAw8JCiRco33DAAALA0lEQVR42u2ce4xV1RXGf2sYQB7yEGMrFfGFBkF8oFZbC0bjK9YiPrBqoMVWaRq10Vbtw9TEpI20pbZpsVVrFQpoVaDV+KhofFKkgEVBVEAUH1WoFJBBXsN8/eOsG443Z597L3Pnzh2zv+Rk5u6z9jnrrL3O2muvtfaBiIiIiIiIiIiIiIiIiIiIiIiIiIggrFY3ktQXuADoDywGHjIz1fqBJR0NnAa0AI+Z2atRDSJKKU1/SQdlHI0pmqGS3ten8Q9JnWvM6/clNad42C7p2x1Axn0lHZZx7B01sDYD8LSyMTBFMz9Ac10N+RxapOAFbJG0f53L+PqA/H4WNbA0GmowQD2B4wKnT6nhs44AOmW07wF8KapCu73AvdMGsUMqObDFjyysq6E81+ec+1+G8AdLejPjmB1Vs2oKfirwHvC2pN92WCU3s53A1KxnBO6poUwfB/6T0b4CeD6jvQtwUMbxhQ6mSIdLGi7p4Dpk70qgp/9/laReHdWSA/wAuDv1exNwhZk9WStpmtl64BxgWar538AoM9vyGTaY9wMLgUl1yFt6LFYDTW1xk8YaKdhm4DJJ15CEEFea2Y5aS9TMXgKGuA/YYmbvRqehXXGzu4r9gclm1tJhlTylZBuBje0tWTNbHfWr/WFm22oxwzSW8OeGAycAA7zpI2AeMK+St05SD/dxi7HZzLaX6NsV+AowDNjHF5DvAXPMbG2KrjvQtah7s5ltStH0zbqFmW3w812AHt4e8g8bM66zMU8ekoYBw4EDXQ7bgI+BN4GXzOydqPK1X6yMlvSqwlgl6TynLSdOPiVAc3EOD70lTZS0IdB3h6TZkgY4/e0ZNC+krtcpcJ1PUjQXavewbwb/3Ty+vaKM/gskjZNkAVnsdpxc0lKn/dtnTEd7STpC0ghfWPcoa+EpqVHSXcAs4PCcexwIzJR0C21QGiDpWGApcD3QO2cWOhd4WdKIOhuA44A3gInAIWV0ORaYAjwhac9W3nuApIWFwyNCACPT7X50lnSz//+Cz5rl3OMS77NA0l5l9jkrdd9TU4as0HZpoN+Dfv6H/nt/SX8B1gCvAM/6wnqd0w4uxcjU3bBi26tpySUNk7SxQh7+62UC7W7JJR0lqUm7j6eKLXolllzSIRXcq4vP2gWMKlNhn0j1+UaZfWY6fZMnCJHUL3WdawP9XvPzkyWd5GOdh08knZtpySWNA8buhvHoXEUL2NVDXpXGS/cGTq8DC94JmJ7y64vxLvAUMDcnXHYKcFEr2FgLTEgdhdzAy0XtE4Bm4BF2JeUuLuMZ+wAjU02jy3EtgLP852wz251QYT/gr/53KnAisCfQDTgGuJMk99INmCHpsGImOkt6J+fteEDSaW4lRrj/u7PEG1WxJZd0Vc71Vkua4MVf/SWdLemZEjxUaslHSJrjx7wA/YYUTeHYK7WWyUKzpPGS0kaln6RZAfrHaumTS/qj02wuWNkc2rEZlrNHiT7jU/RnFsmgXEve4sfYnPtcnrreQ8Unz89RlOsCF7y0DZR8eYDuZUn9Mniw1AC1WsmLrn1kgH5ujpDvCPT5Zc7ien0GfVONlfyk1DUvKdPtWJByVc8v0afgSn5YVJ1aiZJL0t1lPO+TTruzoIMNJaacZ4FfBWKc04EHqzjVHw4MyjoFjDWzdRk8CLiaJDVfD5gGjMk4JuXkDZZmnOrRVinuAOYCb5VyWTxMe4b/vAd4ppTLImkfdhXi3Wtmza3g8xdl0NyWcsVHpOPkoejEpBIbG24l2QhRDRwbaH/OzF7JSShsl/QH4Nd1kNx4rsIXuzsQyhP08lh6LfiWpBnAT4AzJPXLMiqu4D3c8PydZOPJacBXJXUJ5DwuSunZ9Faw+ZaZvVYGXXoMBgE0uD+1XwZxsy+S8vBiFQciVNM9r4y+L9ZpLLer+/kTPOY/1aMnyyRtADYTLje2GrM7LRVIOC9AU7DY883sPQ81t3iYN/QchZlhhZktbI2Sl/nCfuS6C0kZNY3OYJZA15rZJyUu2CJpNXBEFYQcitGWsxLfVGfKfRBwo7sqPTpCcsXMXpe0iCQze7FHKz4VnADOLkRIvM8aSfM90jGapNIz3WcgScYcsitRK0EltU7NrtsNBb+lUw5huResBrYF2stJjvSpIwU/i6S6cXxHUfAMaz5SUnFJ8clAIfGTXsQW6utHeQg1jUvdgAqY0VrR7m7HBsIbGspd+PSukoBD9RsnlNH3y3Wi4IcCDwRkJ5LS0pm+gPoOSWx/ZR0p+Qw3Wg3AhQFXZYmZLc9Q8s+5Rc9yVeaa2ar2eqgGkkRAll/dR9KgEoO6F3BAlXgJ+WsjJB2Zw8MeJImNesBNAev9AjDIzIaY2QVmdoOZ3W5mc4CtdeSyrAWeLI6yeAb2nCKlLvRZCSwpjrJIOgIYWoUFZ+uV3KMnIQUrlQG9hCptvDCzZcDywAJsSlYFoQt/EkktTbWxoxL3yafqczJObQZGm9mb9e5qFSnk8Skj98VUcCJr+1+h7bxUSULhJdnus1v7Kbn/fThw/hpJBwQGtS/w4yrz8/tA+5HAAs+2fV5ST0knk6Skv9tGsglFjQ4N7O7vHXgBVvqKP7RA3a/OlHx2arE/pshCv21mi3OU/ADgKFf0r3vbo4FwZM2VfIpbnGL0BOZ4VWDx4DwO7Ftlfu4AXg+cO9hX6B94NOVpdtVDtAU+DMikK/Cwp/CHSxrpWbwmYGcW3zmVhT+qxVLB/3Yrc0bdnFpYFioDCwVPMwN9FgOrUi/EianZdXp7v7UNzuR6AplNklLRBZIWeQ3L8+5WHN8GPuE2X/BUGntvagNemoF/Bk4PI4kRLyTJ+vXwRMjygKG4Px2t8JloElCLDxsVZDM4nVIv02UZ7CWwh+a4KhRFXEanXJWNPtu2v5I7bgEW5NAeQ5LdPIlPhx1XVlm5lpIkFt4vs8sG4PI2ks/tFdLfFmg/E3jLN6K8RFIpeG2NxrhQvzMAuDFdJJaDOT6TARQ+FbGG/MRcQcmHAuP8/wfqYZN4Q0q5tvrCaUkF/dcAV7SBFV1EkmD6TQkr/YS/fMvaSD6zgIcqfCkeD5zrTLIR5eiU67DTIzJtickpt+smYJUXMS3OiGsX5L8TuM9/FgrjZpfY8jg39WIUQqjT6mGR0VD0cGtIYs73UDr4vphk7+WHbRTOWm9m15Ds6zwbuIFkp81PgcuAgWZ2hpnlpXtbWsmDSGov/lzOtfwLBGN8jVNKfh/41H5fWw6wmb3tz1D4uNJA4FRfzOeVDkwLLC5D92kpCmC8Q/b3bGqOxgxmNwHjJd3qynSK++VdSTYyL/MF4L1mttWrzCZmXDu9K/8RH9RiLCtjkLYAj/oRQvccVya9AMvic0eJ+28FvuXlsqPcEu/j19vmC+WtRfL7pqTJ7pueTvJBoj4uvzdcYe4ysw3+0c6JJaI788muwHuuTEV/xIMFY4DBzvf7eS+umS2SNJ5dG9CfKeNWk9gVjl5Rxmb3zezKcYRcoZtcdpV8PuRKd6lfqau4laQ+GXsQC8eAEn2vDtRb/46IiDpT9LUBZb0qp093SSsD/b4WpRpRb0p+W0BZm3yTcaci+gNTO0Gytst1jVKNqDclH+TfCw/hXf/OyyxJ/wp8b7yAcVGiEfWq6N9T63FnlGREvSv6DTnfc8lDi6SfV5DZi4hoV0UfIulPktaVodxNvrXsmCi5iGJYB1D2RpI4/RCS+HQvkuzhxyRx8CUkhfzNcTgjIiIiIiIiIiIiIiIiIiIiIiIiIiIqxP8Ba6LWjDM9F98AAAAASUVORK5CYII="},"182a":function(e,t,n){},"1cef":function(e,t,n){"use strict";n("a8f9")},2:function(e,t){},3:function(e,t){},"3a8c":function(e,t,n){e.exports=n.p+"img/TF-small.726ddef6.svg"},"3d02":function(e,t,n){"use strict";n("4e1c")},"3f38":function(e,t,n){"use strict";n("c05b")},4:function(e,t){},4284:function(e,t,n){"use strict";n("0db0")},"472a":function(e,t,n){"use strict";n("ff34")},"4e1c":function(e,t,n){},5:function(e,t){},"57d9":function(e,t,n){"use strict";n("eec3")},"5ba5":function(e,t,n){"use strict";n("e6e1")},6:function(e,t){},"679b":function(e,t,n){"use strict";n("70f2")},7:function(e,t){},"70f2":function(e,t,n){},"72f0":function(e,t,n){"use strict";n("d703")},"7eb9":function(e,t,n){},8:function(e,t){},9:function(e,t){},"91c7":function(e,t,n){},"9ddc":function(e,t,n){},"9f33":function(e,t,n){"use strict";n("e4b3")},a8f9:function(e,t,n){},af4b:function(e,t,n){},b1c5:function(e,t,n){"use strict";n("112d")},badd:function(e,t,n){"use strict";n("182a")},bafe:function(e,t,n){},c05b:function(e,t,n){},c1c9:function(e,t,n){"use strict";n("da42")},cd49:function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var c=n("7a23");function a(e,t,n,a,o,r){var s=Object(c["resolveComponent"])("router-view");return Object(c["openBlock"])(),Object(c["createBlock"])(c["Suspense"],null,{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])(s)]})),_:1})}console.log("Commit hash: ".concat("gdd40389")),console.log("Version: ".concat("v0.3.1-rc05"));var o=Object(c["defineComponent"])({name:"App"});n("f6d5");o.render=a;var r=o,s=(n("d940"),n("1da1")),l=(n("96cf"),n("45fc"),n("6c02")),i=(n("b0c0"),Object(c["withScopeId"])("data-v-388f1f64"));Object(c["pushScopeId"])("data-v-388f1f64");var u={class:"grid place-items-center h-screen"},d=Object(c["createTextVNode"])(" Welcome "),p=Object(c["createTextVNode"])(", to your digitalTwin. "),f=Object(c["createVNode"])("p",null,"Automaticly redirecting you in 3 seconds ...",-1);Object(c["popScopeId"])();var b=i((function(e,t,n,a,o,r){return Object(c["openBlock"])(),Object(c["createBlock"])("div",u,[Object(c["createVNode"])("h1",null,[d,Object(c["createVNode"])("b",null,Object(c["toDisplayString"])(e.name),1),p]),f,Object(c["createVNode"])("button",{class:"fancyButton",onClick:t[1]||(t[1]=function(){return e.loginAndPush&&e.loginAndPush.apply(e,arguments)})}," Verify my identity ")])})),m=(n("4795"),n("1276"),n("ac1f"),function(){var e="/api/auth/signin";window.location.href=e+"?username="+window.location.host.split(".")[0]}),v=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("Attempting to login ..."),e.next=3,m();case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=Object(c["defineComponent"])({name:"Home",mounted:function(){setTimeout((function(){v()}),3200)},setup:function(){return{name:window.location.host.split(".")[0],loginAndPush:v}}});n("3f38");O.render=b,O.__scopeId="data-v-388f1f64";var j=O;function g(e,t,n,a,o,r){var s=Object(c["resolveComponent"])("app-layout");return Object(c["openBlock"])(),Object(c["createBlock"])(s,null,{default:Object(c["withCtx"])((function(){return[Object(c["createVNode"])("iframe",{src:e.computedUrl,style:{position:"relative",top:"0",left:"0",bottom:"0",right:"0",width:"100%",height:"100%",border:"none",margin:"0",padding:"0",overflow:"hidden","z-index":"999999"}},"\n            Your browser doesn't support iframes\n        ",8,["src"])]})),_:1})}var h=Object(c["withScopeId"])("data-v-25b66247");Object(c["pushScopeId"])("data-v-25b66247");var k={class:"bg-gray-100 h-full overflow-hidden relative text-sm"},w={class:"pl-0 relative h-full w-full maingrid md:bigmaingrid"},y={class:"top h-20 md:hidden"},x={class:"side hidden md:block"},V={class:"content w-full h-full overflow-y-auto relative flex flex-col"},N={class:"relative w-full h-full overflow-y-auto"},C={class:"absolute w-full h-full"};Object(c["popScopeId"])();var S=h((function(e,t,n,a,o,r){var s=Object(c["resolveComponent"])("UserConfigDialog"),l=Object(c["resolveComponent"])("Topbar"),i=Object(c["resolveComponent"])("Sidebar");return Object(c["openBlock"])(),Object(c["createBlock"])(c["Fragment"],null,[(Object(c["openBlock"])(),Object(c["createBlock"])(c["Suspense"],null,{default:h((function(){return[Object(c["createVNode"])(s)]})),_:1})),Object(c["createVNode"])("div",k,[Object(c["createVNode"])("div",w,[Object(c["createVNode"])("div",y,[Object(c["createVNode"])(l,null,{default:h((function(){return[Object(c["renderSlot"])(e.$slots,"top")]})),actions:h((function(){return[Object(c["renderSlot"])(e.$slots,"actions")]})),_:1})]),Object(c["createVNode"])("div",x,[Object(c["renderSlot"])(e.$slots,"side",{},(function(){return[Object(c["createVNode"])(i,{class:"bg-icon md:block h-full"})]}))]),Object(c["createVNode"])("div",V,[Object(c["createVNode"])("div",N,[Object(c["createVNode"])("div",C,[Object(c["renderSlot"])(e.$slots,"default")])])])])])],64)})),B=n("8468"),I=(n("caad"),n("2532"),n("3a8c")),A=n.n(I),D=n("17df"),R=n.n(D),M=Object(c["withScopeId"])("data-v-45e98e26");Object(c["pushScopeId"])("data-v-45e98e26");var E={class:"flex flex-col h-full items-center mx-2"},T={class:"mb-4 grid text-center text-white cursor-pointer"},U=Object(c["createVNode"])("img",{src:A.a,width:"50",alt:"Threefold logo"},null,-1),L=Object(c["createVNode"])("img",{src:R.a,width:"100",alt:"Threefold logo"},null,-1),F=Object(c["createVNode"])("br",null,null,-1),G={class:"grid place-items-end flex-grow"};Object(c["popScopeId"])();var q=M((function(e,t,n,a,o,r){var s=Object(c["resolveComponent"])("AvatarImg");return Object(c["openBlock"])(),Object(c["createBlock"])("nav",null,[Object(c["createVNode"])("div",E,[Object(c["createVNode"])("div",T,[Object(c["createVNode"])("div",{class:"h-20 w-20 rounded-full grid place-items-center mb-1",style:{position:"relative"},onClick:t[1]||(t[1]=function(t){return e.changePage("chat")})},[U,L])]),F,(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(e.apps,(function(t){var n,a;return Object(c["openBlock"])(),Object(c["createBlock"])("div",{key:t.name,class:["mb-4 grid text-center",{"text-gray-300":!(null!==t&&void 0!==t&&t.enabled),"cursor-pointer":t.enabled,"text-white":!(null!==(n=e.router.currentRoute)&&void 0!==n&&n.value.path.includes(t.name)),selected:null===(a=e.router.currentRoute)||void 0===a?void 0:a.value.path.includes(t.name)}]},[Object(c["createVNode"])("div",{class:"h-20 w-20 rounded-full grid place-items-center mb-1",style:{position:"relative"},onClick:function(n){return e.changePage(t.name)}},[Object(c["createVNode"])("i",{class:"fas ".concat(t.icon," text-2xl")},null,2),Object(c["createVNode"])("h3",null,Object(c["toDisplayString"])(t.name),1)],8,["onClick"])],2)})),128)),Object(c["createVNode"])("div",G,[Object(c["createVNode"])("div",{class:"w-20 h-20 grid cursor-pointer items-center justify-center justify-items-center",onClick:t[2]||(t[2]=function(){return e.toggleShowUserConfigDialog&&e.toggleShowUserConfigDialog.apply(e,arguments)})},[Object(c["createVNode"])(s,{id:e.user.id},null,8,["id"])])])])])})),W=(n("c96a"),{key:1,class:"absolute -top-1 -right-1 bg-accent h-4 w-4 rounded-full text-xs z-10 align-middle text-center text-white"});function P(e,t){return Object(c["openBlock"])(),Object(c["createBlock"])("div",{class:["grid relative",{"h-16 w-16":e.large,"h-12 w-12":!e.small&&!e.xsmall,"h-8 w-8":e.small,"h-6 w-6":e.xsmall}]},[Object(c["createVNode"])("div",{class:["bg-icon rounded-full",{"h-16 w-16":e.large,"h-12 w-12":!e.small&&!e.xsmall&&!e.large,"h-8 w-8":e.small,"h-6 w-6":e.xsmall}],style:"background:url(".concat(e.src,") no-repeat center/cover")},null,6),e.showOnlineStatus?(Object(c["openBlock"])(),Object(c["createBlock"])("div",{key:0,class:["h-3 w-3 bg-gray-300 rounded-full absolute bottom-0 right-0 transition-all",{"bg-red-500":e.status&&!e.status.isOnline,"bg-green-500":e.status&&e.status.isOnline}]},null,2)):Object(c["createCommentVNode"])("",!0),e.unreadMessagesAmount>0?(Object(c["openBlock"])(),Object(c["createBlock"])("div",W,Object(c["toDisplayString"])(e.unreadMessagesAmount),1)):Object(c["createCommentVNode"])("",!0)],2)}n("a9e3"),n("99af"),n("7db0"),n("fb6a"),n("c975");var Y=n("bc3a"),_=n.n(Y),J=n("a1e9"),z=n("5530"),H=(n("5319"),function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,_.a.get("".concat(window.location.origin,"/api/user/getStatus"));case 2:return t=e.sent,e.abrupt("return",t.data.status);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()),Q=Object(J["k"])({user:{id:window.location.host.split(".")[0].replace("localhost:8080","localhost:3000"),image:"".concat(window.location.origin,"/api/user/avatar/default"),email:"testemail",status:"",location:"@TODO implement this"}}),Z=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,_.a.get("".concat(window.location.origin,"/api/yggdrasil_address"));case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),K=function(){return Object(z["a"])({},Q)},X=(n("a434"),n("a15b"),function(e){return"".concat(window.location.origin,"/getExternalResource?resource=").concat(e)}),$=Object(J["k"])({}),ee=[],te=[],ne=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var n,c,a,o,r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=K(),c=n.user,a="/api/user/getStatus",o="",o=t==c.id?"".concat(window.location.origin).concat(a):X("http://[".concat(te[t].location,"]").concat(a)),e.next=6,_.a.get(o);case 6:return r=e.sent,s=r.data,$[t]=s,e.abrupt("return",s);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ce=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!te.find((function(e){return e===t.id}))){e.next=2;break}return e.abrupt("return");case 2:return te.push(t.id),te[t.id]={location:t.location},ee.push(t.id),e.next=7,ne(t.id);case 7:ee.slice(ee.indexOf(t.id),1),setInterval(Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,-1===ee.indexOf(t.id)){e.next=3;break}return e.abrupt("return");case 3:return ee.push(t.id),e.next=6,ne(t.id);case 6:ee.slice(ee.indexOf(t.id),1),e.next=12;break;case 9:e.prev=9,e.t0=e["catch"](0),setTimeout((function(){ee.slice(ee.indexOf(t.id),1)}),1e4);case 12:case"end":return e.stop()}}),e,null,[[0,9]])}))),5e3);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ae={name:"AvatarImg",props:{id:{required:!0},showOnlineStatus:{required:!1,default:!0,type:Boolean},unreadMessagesAmount:Number,large:{required:!1,default:!1,type:Boolean},small:{required:!1,default:!1,type:Boolean},xsmall:{required:!1,default:!1,type:Boolean}},setup:function(e){var t=Object(c["computed"])((function(){return $[e.id]})),n=Object(c["computed"])((function(){return t.value&&t.value.avatar?X(t.value.avatar):"https://avatars.dicebear.com/4.5/api/jdenticon/".concat(encodeURI(e.id),".svg?m=14&b=%23ffffff")}));return{src:n,status:t}}};ae.render=P;var oe=ae,re=Object(c["ref"])(!1),se=Object(c["ref"])(!1),le=Object(c["defineComponent"])({name:"Sidebar",components:{AvatarImg:oe},setup:function(){var e=[{name:"chat",icon:"fas fa-comments",enabled:!0},{name:"filebrowser",icon:"fas fa-file-alt",enabled:!0},{name:"forum",icon:"fas fa-stream",enabled:!1},{name:"meetings",icon:"fas fa-video"}],t=Object(l["d"])(),n=Object(c["computed"])((function(){return t.currentRoute.value})),a=function(e){t.push({name:e})},o=K(),r=o.user,s=function(){console.log("Showing user config dialog: ",se.value),se.value=!se.value,console.log("Showing user config dialog: ",se.value)};return{currentRoute:n,apps:e,changePage:a,user:r,showUserConfigDialog:se,router:t,toggleShowUserConfigDialog:s}}});n("13f1");le.render=q,le.__scopeId="data-v-45e98e26";var ie=le,ue=Object(c["withScopeId"])("data-v-99cf5eb6");Object(c["pushScopeId"])("data-v-99cf5eb6");var de=Object(c["createVNode"])("h1",null,"Profile settings",-1),pe={class:"avatar-container"},fe={class:"flex"},be=Object(c["createVNode"])("i",{class:"fas fa-pen text-white"},null,-1),me={class:"text-center my-4"},ve={class:"relative w-full h-full"},Oe=Object(c["createVNode"])("i",{class:"fas fa-pen"},null,-1),je=Object(c["createVNode"])("i",{class:"fas fa-check"},null,-1),ge=Object(c["createVNode"])("h2",null,"Blocked Users",-1),he={class:"max-h-28 overflow-y-auto"},ke=Object(c["createVNode"])("h1",null,"Avatar",-1),we={class:"flex w-full flex-col"},ye={class:"w-full"},xe={class:"flex flex-row justify-end"},Ve=Object(c["createTextVNode"])(" SAVE "),Ne=Object(c["createTextVNode"])(" CANCEL ");Object(c["popScopeId"])();var Ce,Se,Be=ue((function(e,t){var n=Object(c["resolveComponent"])("AvatarImg"),a=Object(c["resolveComponent"])("vue-cropper"),o=Object(c["resolveComponent"])("Button"),r=Object(c["resolveComponent"])("jdialog");return Object(c["openBlock"])(),Object(c["createBlock"])(r,{modelValue:e.showUserConfigDialog,"onUpdate:modelValue":t[9]||(t[9]=function(t){return e.showUserConfigDialog=t}),noActions:""},{title:ue((function(){return[de]})),default:ue((function(){return[Object(c["createVNode"])("div",null,[Object(c["createVNode"])("div",pe,[Object(c["createVNode"])("div",fe,[Object(c["createVNode"])("div",{class:"avatar-container mr-2 flex justify-center items-center cursor-pointer",onMouseover:t[2]||(t[2]=function(t){return e.isHoveringAvatar=!0}),onMouseleave:t[3]||(t[3]=function(t){return e.isHoveringAvatar=!1})},[Object(c["createVNode"])("div",{class:["overlay flex justify-center items-center",e.isHoveringAvatar?"block":"hidden"],onClick:t[1]||(t[1]=function(){return e.selectFile&&e.selectFile.apply(e,arguments)})},[be],2),Object(c["createVNode"])(n,{id:e.user.id,large:""},null,8,["id"])],32),Object(c["createVNode"])("h1",me,Object(c["toDisplayString"])(e.user.id),1)])]),Object(c["createVNode"])("div",ve,[Object(c["createVNode"])(c["Transition"],{name:"fade"},{default:ue((function(){return[e.isEditingStatus?Object(c["createCommentVNode"])("",!0):(Object(c["openBlock"])(),Object(c["createBlock"])("button",{key:0,class:"absolute top-0 right-0",onClick:t[4]||(t[4]=function(t){return e.setEditStatus(!0)})},[Oe]))]})),_:1}),Object(c["createVNode"])(c["Transition"],{name:"fade"},{default:ue((function(){return[e.isEditingStatus?(Object(c["openBlock"])(),Object(c["createBlock"])("button",{key:0,class:"absolute top-1 right-0",onClick:t[5]||(t[5]=function(){return e.sendNewStatus&&e.sendNewStatus.apply(e,arguments)})},[je])):Object(c["createCommentVNode"])("",!0)]})),_:1}),(Object(c["openBlock"])(),Object(c["createBlock"])(c["Suspense"],null,{default:ue((function(){return[Object(c["withDirectives"])(Object(c["createVNode"])("textarea",{"onUpdate:modelValue":t[6]||(t[6]=function(t){return e.userStatus=t}),class:"w-full",disabled:!e.isEditingStatus,placeholder:e.myStatus},null,8,["disabled","placeholder"]),[[c["vModelText"],e.userStatus]])]})),_:1}))]),Object(c["createVNode"])("input",{class:"hidden",type:"file",id:"fileInput",ref:"fileInput",accept:"image/*",onChange:t[7]||(t[7]=function(){return e.changeFile&&e.changeFile.apply(e,arguments)})},null,544),Object(c["createVNode"])("div",null,[ge,Object(c["createVNode"])("ul",he,[(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(e.blockedUsers,(function(t){return Object(c["openBlock"])(),Object(c["createBlock"])("li",{key:t},[Object(c["createTextVNode"])(Object(c["toDisplayString"])(t)+" ",1),Object(c["createVNode"])("button",{class:"px-4 py-2 text-base font-medium rounded-md text-white bg-blue-600 hover:bg-blue-500 focus:border-blue-700 active:bg-blue-700 ease-in-out duration-150 cursor-pointer uppercase",onClick:function(n){return e.unblockUser(t)}}," unblock ",8,["onClick"])])})),128))])])]),Object(c["createVNode"])(r,{modelValue:e.showEditAvatar,"onUpdate:modelValue":t[8]||(t[8]=function(t){return e.showEditAvatar=t}),noActions:""},{title:ue((function(){return[ke]})),default:ue((function(){return[Object(c["createVNode"])("div",we,[Object(c["createVNode"])("div",ye,[Object(c["createVNode"])(a,{ref:"cropper","aspect-ratio":1,src:e.src,viewMode:2,zoomable:!1,guides:!1,minCanvasWidth:64,minCropBoxWidth:64,containerStyle:{"max-height":"400px"},background:!1},null,8,["src"])]),Object(c["createVNode"])("div",xe,[Object(c["createVNode"])(o,{onClick:e.saveNewAvatar},{default:ue((function(){return[Ve]})),_:1},8,["onClick"]),Object(c["createVNode"])(o,{onClick:e.cancelNewAvatar},{default:ue((function(){return[Ne]})),_:1},8,["onClick"])])])]})),_:1},8,["modelValue"])]})),_:1},8,["modelValue"])})),Ie=(n("d3b7"),n("2909")),Ae=n("ade3"),De=(n("2b3d"),n("3ca3"),n("ddb0"),n("4160"),n("159b"),n("4de4"),n("0d03"),n("c740"),n("25f0"),n("6eba"),n("4e82"),n("c1df")),Re=n.n(De);(function(e){e["REMOVE_USER"]="REMOVEUSER",e["ADD_USER"]="ADDUSER",e["JOINED_VIDEOROOM"]="JOINED_VIDEOROOM"})(Ce||(Ce={})),function(e){e["STRING"]="STRING",e["SYSTEM"]="SYSTEM",e["GIF"]="GIF",e["MESSAGE"]="MESSAGE",e["FILE"]="FILE",e["FILE_UPLOAD"]="FILE_UPLOAD",e["EDIT"]="EDIT",e["READ"]="READ",e["CONTACT_REQUEST"]="CONTACT_REQUEST",e["DELETE"]="DELETE",e["QUOTE"]="QUOTE"}(Se||(Se={}));var Me=window.location.host.split(".");Me.shift();var Ee={baseUrl:"".concat(window.location.origin,"/"),spawnerUrl:"https://".concat(Me.join("."),"/"),giphyApiKey:"uk3XRSO0vYrPDEQKDPZJ2wGz33qzIxST"},Te=Ee;function Ue(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0,n="x"==e?t:3&t|8;return n.toString(16)}))}var Le,Fe=n("2ef0"),Ge=Object(J["k"])({scrollEvents:[]}),qe=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];Ge.scrollEvents.push(e)},We=function(){Ge.scrollEvents.pop()},Pe=function(){Ge.scrollEvents=[]},Ye=function(){return Object(z["a"])({},Ge)},_e=function(){return{addScrollEvent:qe,popScrollEvent:We,clearScrollEvents:Pe}},Je=50,ze=Object(J["k"])({chats:[],chatRequests:[],chatInfo:{}}),He=Object(c["ref"])(""),Qe=Object(c["ref"])(void 0);(function(e){e["EDIT"]="EDIT",e["REPLY"]="REPLY"})(Le||(Le={}));var Ze=Object(J["k"])({actions:{}}),Ke=function(e,t,n){var c;Ze.actions=Object(z["a"])(Object(z["a"])({},null!==(c=Ze.actions)&&void 0!==c?c:{}),{},Object(Ae["a"])({},e,{message:t,type:n}))},Xe=function(e){var t;Ze.actions=Object(z["a"])(Object(z["a"])({},null!==(t=Ze.actions)&&void 0!==t?t:{}),{},Object(Ae["a"])({},e,void 0))},$e=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=new URLSearchParams,t.append("limit",Je.toString()),e.next=4,_.a.get("".concat(Te.baseUrl,"api/chats"),{params:t}).then((function(e){var t=e.data;t.forEach((function(e){console.log(e),at(e)})),gt()}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),et=function(e){return ze.chats.find((function(t){return t.chatId===e}))},tt=function(e,t){var n;ze.chatInfo[e]=Object(z["a"])(Object(z["a"])({},null!==(n=ze.chatInfo[e])&&void 0!==n?n:{isLoading:!1}),{},{hasMoreMessages:t})},nt=function(e,t){var n;ze.chatInfo[e]=Object(z["a"])(Object(z["a"])({},null!==(n=ze.chatInfo[e])&&void 0!==n?n:{hasMoreMessages:!1}),{},{isLoading:t})},ct=function(e){return Object(c["readonly"])(ze.chatInfo[e])},at=function(e){if(tt(e.chatId,e.messages&&e.messages.length>=Je),!e.isGroup){var t=K(),n=t.user,c=e.contacts.find((function(e){return e.id!==n.id}));c&&ce(c)}e.acceptedChat?(ze.chats.push(e),ze.chats=Object(Fe["uniqBy"])(ze.chats,(function(e){return e.chatId}))):ze.chatRequests.push(e),gt()},ot=function(e){var t;ze.chats=ze.chats.filter((function(t){return t.chatId!==e})),gt(),He.value=null===(t=ze.chats.find((function(){return!0})))||void 0===t?void 0:t.chatId},rt=function(e,t){var n=K(),c=n.user,a={isGroup:!0,chatId:Ue(),contacts:t,messages:[{from:c.id,to:e,body:{message:"".concat(c.id," has created and invited you to ").concat(e)},timeStamp:new Date,id:Ue(),type:Se.SYSTEM,replies:[],subject:null}],name:e,adminId:c.id,read:{},acceptedChat:!0};_.a.put("".concat(Te.baseUrl,"api/group"),a).then((function(e){console.log(e)}))["catch"]((function(e){console.log("failed to add groupchat",e)}))},st=function(e){_.a.post("".concat(Te.baseUrl,"api/chats?id=").concat(e)).then((function(){var t=ze.chatRequests.findIndex((function(t){return t.chatId==e}));ze.chatRequests[t].acceptedChat=!0,at(ze.chatRequests[t]);var n=K(),c=n.user;mt(e,"".concat(c.id," accepted invitation")),ze.chatRequests.splice(t,1)}))["catch"]((function(e){console.log("Got an error: ",e)}))},lt=function(e){ot(e.chatId),at(e)};function it(e,t){var n=e.messages.find((function(e){return e.id===t}));return n||e.messages.find((function(e){var c=e.replies.find((function(e){return e.id===t}));return!!c&&(n=c,!0)})),n}var ut=function(e,t){t&&(e.messages=t.concat(e.messages))},dt=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,n,c){var a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=new URLSearchParams,c&&a.append("fromId",c),a.append("limit",n.toString()),e.next=5,_.a.get("".concat(Te.baseUrl,"api/messages/").concat(t),{params:a});case 5:if(o=e.sent,!(200>o.status&&o.status>=300)){e.next=9;break}return console.error(o.statusText+": failed fetching more messages"),e.abrupt("return");case 9:return e.abrupt("return",o.data);case 10:case"end":return e.stop()}}),e)})));return function(t,n,c){return e.apply(this,arguments)}}(),pt=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var n,c,a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=ct(t),n&&!n.isLoading&&n.hasMoreMessages){e.next=3;break}return e.abrupt("return");case 3:if(e.prev=3,nt(t,!0),a=et(t),a){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,dt(a.chatId,Je,null===(c=a.messages[0])||void 0===c?void 0:c.id);case 10:return o=e.sent,tt(a.chatId,o.hasMore),ut(a,o.messages),e.abrupt("return",o.messages.length>0);case 16:return e.prev=16,e.t0=e["catch"](3),e.abrupt("return",!1);case 19:return e.prev=19,nt(t,!1),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[3,16,19,22]])})));return function(t){return e.apply(this,arguments)}}(),ft=function(e,t){if("READ"!==t.type){if("REMOVEUSER"!==t.type&&"ADDUSER"!==t.type){var n=et(e);if(t.subject){var c=n.messages.findIndex((function(e){return e.id===t.subject}));if(-1===c)return;var a=n.messages[c],o=a.replies.findIndex((function(e){return e.id===t.id}));if(-1===o)return;var r=a.replies[o];return t.type===Se.DELETE||t.type===Se.EDIT?r.body=t.body:(a.replies=[].concat(Object(Ie["a"])(a.replies),[t]),n.messages[c]=a),void jt(e,t)}if("EDIT"!==t.type){var s=n.messages.findIndex((function(e){return e.id==t.id}));-1!==s&&(n.messages[s]=t),-1===s&&n.messages.push(t),gt(),jt(e,t);var l=_e(),i=l.addScrollEvent;i()}else{var u=n.messages.findIndex((function(e){return e.id==t.body.id}));if(-1===u)return;n.messages[u]=t.body}}}else{var d=et(e),p=it(d,t.body),f=it(d,t.from);if(f&&new Date(p.timeStamp).getTime()>new Date(f.timeStamp).getTime())return;d.read=Object(z["a"])(Object(z["a"])({},d.read),{},Object(Ae["a"])({},t.from,t.body))}},bt=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"STRING",c=qt(),a=c.sendSocketMessage,o=K(),r=o.user,s={id:Ue(),body:t,from:r.id,to:e,timeStamp:new Date,type:n,replies:[],subject:null};ft(e,s),a(e,s)},mt=function(e,t){bt(e,{message:t},Se.SYSTEM)},vt=function(e,t){var n=qt(),c=n.sendSocketMessage;"SYSTEM"!==t.type&&ft(e,t);var a="EDIT"===t.type||"DELETE"===t.type;c(e,t,a)},Ot=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,n){var c,a,o,r,s,l,i=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return c=i.length>2&&void 0!==i[2]&&i[2],a=K(),o=a.user,r=Ue(),s=new FormData,c?s.append("file",n,"recording-".concat(Date.now(),".WebM")):s.append("file",n),l={id:r,body:"Uploading file in progress ...",from:o.id,to:t,timeStamp:new Date,type:"FILE_UPLOAD",replies:[],subject:null},ft(t,l),e.prev=7,e.next=10,_.a.post("".concat(Te.baseUrl,"api/files/").concat(t,"/").concat(r),s,{headers:{"Content-Type":"multipart/form-data"}});case 10:console.log("File uploaded."),e.next=18;break;case 13:e.prev=13,e.t0=e["catch"](7),l.body="Failed to send file: ".concat(e.t0.message),ft(t,l),console.log(e.t0);case 18:case"end":return e.stop()}}),e,null,[[7,13]])})));return function(t,n){return e.apply(this,arguments)}}(),jt=function(e,t){if(ze.chats){var n=ze.chats.find((function(t){return t.chatId==e}));n&&gt()}},gt=function(){ze.chats.sort((function(e,t){var n=e.messages[e.messages.length-1]?e.messages[e.messages.length-1].timeStamp:new Date(-864e13),c=t.messages[t.messages.length-1]?t.messages[t.messages.length-1].timeStamp:new Date(-864e13);return Re()(c).unix()-Re()(n).unix()}))},ht=function(e,t){var n=K(),c=n.user,a={id:Ue(),from:c.id,to:e,body:t,timeStamp:new Date,type:"READ",replies:[],subject:null};vt(e,a)},kt=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,n,c){var a,o,r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a=K(),o=a.user,e.next=3,Z();case 3:r=e.sent,s={id:Ue(),from:o.id,to:t,body:{type:c?Ce.REMOVE_USER:Ce.ADD_USER,message:"".concat(n.id," has been ").concat(c?"removed from":"added to"," the group"),adminLocation:r,contact:n},timeStamp:new Date,type:Se.SYSTEM,replies:[],subject:null},vt(t,s);case 6:case"end":return e.stop()}}),e)})));return function(t,n,c){return e.apply(this,arguments)}}(),wt=function(){return Object(z["a"])({},Object(c["toRefs"])(ze))},yt=function(){return{addChat:at,retrievechats:$e,sendMessage:bt,addMessage:ft,sendFile:Ot,sendMessageObject:vt,addGroupchat:rt,readMessage:ht,acceptChat:st,updateContactsInGroup:kt,updateChat:lt,getNewMessages:pt,getChatInfo:ct}},xt=function(e){var t=K(),n=t.user,c=e.to===n.id?e.from:e.to,a=wt(),o=a.chats,r=o.value.find((function(e){return e.chatId==c})),s=it(r,e.body),l=it(r,e.from);l&&new Date(s.timeStamp).getTime()<new Date(l.timeStamp).getTime()||(r.read[e.from]=e.body)},Vt=(n("d81d"),function(e,t){var n=K(),c=n.user,a={id:Ue(),body:"Request has been sent to ".concat(e),from:c.id,to:e,timeStamp:new Date,type:"SYSTEM",replies:[],subject:null};_.a.post("".concat(Te.baseUrl,"api/contacts"),{id:e,location:t,message:a}).then((function(e){}))}),Nt=function(){var e=wt(),t=e.chats,n=K(),c=n.user,a=t.value.filter((function(e){return!e.isGroup&&e.acceptedChat})).map((function(e){return e.contacts.find((function(e){return e.id!==c.id}))}));return a},Ct=function(){return{contacts:Nt()}},St=function(){return{addContact:Vt}},Bt=[],It=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,_.a.get("".concat(Te.baseUrl,"api/blocked/"));case 3:t=e.sent,Bt=t.data,e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),console.log("could not get blocklist");case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),At=function(){return Bt},Dt=function(e){Bt.push(e)},Rt=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,_.a["delete"]("".concat(Te.baseUrl,"api/blocked/").concat(t,"/"));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Mt=Object(J["k"])({socket:"",notification:{id:"",sound:""}}),Et=function(e){var t=e.id,n=e.sound,c=void 0===n?"beep.mp3":n;Mt.notification={id:t,sound:c}},Tt=function(e){Mt.socket=Object(c["inject"])("socket"),Mt.socket.on("connect",(function(){console.log("connected with socket.")})),Mt.socket.emit("identify",{name:e}),Mt.socket.on("chat_removed",(function(e){console.log("chat_removed"),ot(e)})),Mt.socket.on("chat_blocked",(function(e){ot(e),Dt(e)})),Mt.socket.on("message",(function(e){if("READ"!==e.type){"SYSTEM"===e.type&&"EDIT"===e.type&&"DELETE"===e.type||Et({id:e.id});var t=yt(),n=t.addMessage,c=K(),a=c.user;n(e.to===a.id?e.from:e.to,e)}else xt(e)})),Mt.socket.on("connectionRequest",(function(e){var t=yt(),n=t.addChat,c=Ct(),a=(c.contacts,K());a.user;n(e)})),Mt.socket.on("chat_updated",(function(e){var t=yt(),n=t.updateChat;n(e)})),Mt.socket.on("new_chat",(function(e){var t=yt(),n=t.addChat;n(e)}))},Ut=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,n){var c,a,o,r=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return c=r.length>2&&void 0!==r[2]&&r[2],a={chatId:t,message:n},o=c?"update_message":"message",e.next=5,Mt.socket.emit(o,a);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Lt=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:Mt.socket.emit("remove_chat",t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ft=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:Mt.socket.emit("block_chat",t),Mt.socket.emit("remove_chat",t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Gt=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n={status:t},Mt.socket.emit("status_update",n);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),qt=function(){return{initializeSocket:Tt,sendSocketMessage:Ut,sendSocketUserStatus:Gt,notify:Et}},Wt=function(){return Object(z["a"])({},Object(c["toRefs"])(Mt))},Pt={class:"form-container bg-white p-4 lg:w-2/5 w-10/12 max-w-full rounded"},Yt={class:"flex justify-between"},_t=Object(c["createVNode"])("i",{class:"fas fa-times"},null,-1),Jt={class:"py-2 flex-col"},zt={key:0,class:"flex justify-end"};function Ht(e,t,n,a,o,r){return Object(c["openBlock"])(),Object(c["createBlock"])(c["Transition"],{name:"fade"},{default:Object(c["withCtx"])((function(){return[e.modelValue?(Object(c["openBlock"])(),Object(c["createBlock"])("div",{key:0,onKeydown:t[4]||(t[4]=Object(c["withKeys"])((function(t){return e.$emit("update:modelValue",!1)}),["esc"])),class:"fixed z-50 top-0 left-0 bg-black bg-opacity-50 w-screen h-screen grid place-items-center"},[Object(c["createVNode"])("div",Pt,[Object(c["createVNode"])("div",Yt,[Object(c["renderSlot"])(e.$slots,"title"),Object(c["createVNode"])("button",{onClick:t[1]||(t[1]=function(t){return e.$emit("update:modelValue",!1)})},[_t])]),Object(c["createVNode"])("div",Jt,[Object(c["renderSlot"])(e.$slots,"default")]),e.noActions?Object(c["createCommentVNode"])("",!0):(Object(c["openBlock"])(),Object(c["createBlock"])("div",zt,[Object(c["createVNode"])("button",{onClick:t[2]||(t[2]=function(t){return e.$emit("update:modelValue",!1)})},Object(c["toDisplayString"])(e.cancelButtonText),1),Object(c["createVNode"])("button",{onClick:t[3]||(t[3]=function(t){return e.$emit("update:modelValue",!0)})},Object(c["toDisplayString"])(e.okButtonText),1)]))])],32)):Object(c["createCommentVNode"])("",!0)]})),_:1})}var Qt=Object(c["defineComponent"])({props:{modelValue:{type:Boolean,default:!1},noActions:{type:Boolean,default:!1},okButtonText:{type:String,default:"Ok"},cancelButtonText:{type:String,default:"Cancel"}},emits:["update:modelValue"]});Qt.render=Ht;var Zt=Qt,Kt=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var n,c,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=new FormData,n.append("file",t),c="".concat(Te.baseUrl,"api/user/avatar"),e.prev=3,e.next=6,_.a.post(c,n,{headers:{"Content-Type":"multipart/form-data"}});case 6:return a=e.sent,e.abrupt("return",a.data);case 10:e.prev=10,e.t0=e["catch"](3),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t){return e.apply(this,arguments)}}(),Xt=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t="".concat(Te.baseUrl,"api/auth/authenticated"),e.prev=1,e.next=4,_.a.get(t);case 4:return n=e.sent,e.abrupt("return",n.data);case 8:e.prev=8,e.t0=e["catch"](1),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}(),$t=n("95c3"),en=n.n($t),tn=(n("6107"),Object(c["withScopeId"])("data-v-306034fb"));Object(c["pushScopeId"])("data-v-306034fb");var nn={class:" flex items-center rounded-xl m-2 bg-accent text-white btn"};Object(c["popScopeId"])();var cn=tn((function(e,t,n,a,o,r){return Object(c["openBlock"])(),Object(c["createBlock"])("button",nn,[Object(c["renderSlot"])(e.$slots,"default")])})),an={name:"Button"};n("badd");an.render=cn,an.__scopeId="data-v-306034fb";var on=an,rn=Object(c["defineComponent"])({name:"UserConfigDialog",components:{AvatarImg:oe,jdialog:Zt,VueCropper:en.a,Button:on},emits:["addUser"],created:function(){It()},setup:function(e,t){return Object(s["a"])(regeneratorRuntime.mark((function n(){var a,o,r,i,u,d,p,f,b,m,v,O,j,g,h,k,w,y,x,V,N,C,S,I,A,D,R;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return Object(B["a"])(e),a=K(),o=a.user,r=Object(c["ref"])(!1),i=Object(c["ref"])(),u=Object(c["ref"])(),d=Object(c["ref"])(""),p=Object(c["ref"])(!1),f=Object(l["d"])(),b=Object(l["c"])(),n.next=11,H();case 11:return m=n.sent,v=Object(c["ref"])(null),O=Object(c["ref"])(!1),j=Object(c["ref"])(!1),Object(c["watchEffect"])((function(){if(v.value)if(u.value){var e=new FileReader;e.onload=function(e){v.value.replace(e.target.result)},e.readAsDataURL(u.value)}else v.value.destroy()})),g=function(){b.meta&&b.meta.back?f.push({name:b.meta.back}):se.value=!0},h=function(){i.value.click()},k=function(){var e,t,n=null===(e=i.value)||void 0===e?void 0:e.files[0];n&&-1!==n.type.indexOf("image/")&&(u.value=null===(t=i.value)||void 0===t?void 0:t.files[0],j.value=!0,i.value.value=null)},w=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,fetch(v.value.getCroppedCanvas().toDataURL(u.value.type));case 2:return e.next=4,e.sent.blob();case 4:return t=e.sent,n=new File([t],"avatar",{type:u.value.type}),e.next=8,V(n);case 8:j.value=!1;case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=function(){j.value=!1},x=function(){u.value=null},V=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Kt(t);case 2:return e.next=4,ne(o.id);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=function(e){p.value=e,d.value=o.status},C=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=qt(),n=t.sendSocketUserStatus,n(d.value),o.status=d.value,p.value=!1;case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),S=Object(c["computed"])((function(){return At()})),I=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Rt(t);case 2:se.value=!1;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=function(){t.emit("addUser")},D=Object(c["computed"])((function(){return $[o.id]})),R=Object(c["computed"])((function(){return D.value&&D.value.avatar?X(D.value.avatar):"https://avatars.dicebear.com/4.5/api/jdenticon/".concat(encodeURI(o.id),".svg?m=14&b=%23ffffff")})),n.abrupt("return",{addUser:A,backOrMenu:g,user:o,showEditPic:r,fileInput:i,file:u,selectFile:h,changeFile:k,removeFile:x,sendNewAvatar:V,sendNewStatus:C,userStatus:d,setEditStatus:N,isEditingStatus:p,blockedUsers:S,unblockUser:I,route:b,showUserConfigDialog:se,src:R,myStatus:m,cropper:v,saveNewAvatar:w,isHoveringAvatar:O,showEditAvatar:j,cancelNewAvatar:y});case 31:case"end":return n.stop()}}),n)})))()}});n("472a");rn.render=Be,rn.__scopeId="data-v-99cf5eb6";var sn=rn,ln=Object(c["withScopeId"])("data-v-7e60fd63");Object(c["pushScopeId"])("data-v-7e60fd63");var un={class:"items-center bg-gradient flex justify-between md:topgrid relative h-full px-4 md:px-0"},dn={class:"flex"},pn={class:"h-5 ml-4 items-center"},fn=Object(c["createVNode"])("img",{src:"/TFN.svg",alt:"TF-Logo",class:"md:ml-4 h-full hidden md:flex"},null,-1),bn={class:"h-5 flex items-center col-span-3 md:col-span-1 md:hidden"},mn=Object(c["createVNode"])("img",{src:"/digitaltwin.svg",alt:"TF-Logo",class:"md:hidden md:ml-4 h-full"},null,-1),vn={class:"pr-4 text-right text-gray-500 flex items-center justify-begin"},On={class:"h-5 md:flex text-black items-center col-span-3 md:col-span-1 hidden"},jn=Object(c["createVNode"])("img",{src:"/TFN.svg",alt:"TF-Logo",class:"md:hidden md:ml-4 h-full"},null,-1);Object(c["popScopeId"])();var gn=ln((function(e,t){return Object(c["openBlock"])(),Object(c["createBlock"])("div",un,[Object(c["createVNode"])("div",dn,[Object(c["createVNode"])("div",pn,[Object(c["createVNode"])("button",{class:["text-lg text-white md:hidden w-12",{"md:hidden":!(e.route.meta&&e.route.meta.back)}],onClick:t[1]||(t[1]=function(){return e.backOrMenu&&e.backOrMenu.apply(e,arguments)})},[Object(c["createVNode"])("i",{class:"fas ".concat(e.route.meta&&e.route.meta.back?"fa-chevron-left":"fa-bars")},null,2)],2),fn]),Object(c["createVNode"])("div",bn,[Object(c["renderSlot"])(e.$slots,"default",{},(function(){return[mn]}))])]),Object(c["createVNode"])("div",vn,[Object(c["createVNode"])("div",On,[Object(c["renderSlot"])(e.$slots,"default",{},(function(){return[jn]}))]),Object(c["renderSlot"])(e.$slots,"actions")])])})),hn=Object(c["defineComponent"])({name:"Topbar",components:{AvatarImg:oe,jdialog:Zt},emits:["addUser"],setup:function(e,t){Object(B["a"])(e);var n=K(),a=n.user,o=Object(c["ref"])(!1),r=Object(c["ref"])(!1),i=Object(c["ref"])(),u=Object(c["ref"])(),d=Object(c["ref"])(""),p=Object(c["ref"])(!1),f=Object(l["d"])(),b=Object(l["c"])(),m=function(){b.meta&&b.meta.back?f.push({name:b.meta.back}):se.value=!0},v=function(){i.value.click()},O=function(){var e;u.value=null===(e=i.value)||void 0===e?void 0:e.files[0],g()},j=function(){u.value=null},g=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Kt(u.value);case 2:return e.sent,e.next=5,ne(a.id);case 5:se.value=!1;case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),h=function(e){p.value=e,d.value=a.status},k=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=qt(),n=t.sendSocketUserStatus,n(d.value),a.status=d.value,p.value=!1;case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=Object(c["computed"])((function(){return At()}));Object(c["onBeforeMount"])((function(){It()}));var y=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Rt(t);case 2:se.value=!1;case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),x=function(){t.emit("addUser")};return{addUser:x,backOrMenu:m,user:a,showEditPic:r,showEdit:o,fileinput:i,file:u,selectFile:v,changeFile:O,removeFile:j,sendNewAvatar:g,sendNewStatus:k,userStatus:d,setEditStatus:h,isEditingStatus:p,blockedUsers:w,unblockUser:y,route:b}}});n("c1c9");hn.render=gn,hn.__scopeId="data-v-7e60fd63";var kn=hn,wn=Object(c["defineComponent"])({name:"AppLayout",components:{Sidebar:ie,Topbar:kn,UserConfigDialog:sn},setup:function(e,t){Object(B["a"])(e);var n=Wt(),a=n.notification,o=null;return Object(c["watch"])(a,(function(e,t){var n=document.hasFocus();n||(null===o&&(o=new Audio("/".concat(e.sound))),o.play())})),{}}});n("ede6");wn.render=S,wn.__scopeId="data-v-25b66247";var yn=wn,xn=Object(c["defineComponent"])({name:"Apps",components:{appLayout:yn},setup:function(){var e=K(),t=e.user,n=Object(c["computed"])((function(){return"https://filebrowser.jimbertesting.be/auth/login/user/?username=".concat(t.id,".3bot")}));return{computedUrl:n}}});xn.render=g;var Vn=xn;function Nn(e,t,n,a,o,r){return Object(c["openBlock"])(),Object(c["createBlock"])("iframe",{src:e.computedUrl,allow:"microphone; camera",style:{position:"relative",top:"0",left:"0",bottom:"0",right:"0",width:"100%",height:"100%",border:"none",margin:"0",padding:"0",overflow:"hidden","z-index":"999999"}},"\n        Your browser doesn't support iframes\n    ",8,["src"])}var Cn=Object(c["defineComponent"])({name:"Apps",components:{appLayout:yn},setup:function(){var e=K(),t=e.user,n=Object(l["c"])(),a=Object(c["computed"])((function(){return"https://freeflowconnect.threefold.me/?roomName=".concat(n.params.id,"&username=").concat(t.id,".3bot")}));return{computedUrl:a}}});Cn.render=Nn;var Sn=Cn;function Bn(e,t,n,a,o,r){var s=Object(c["resolveComponent"])("router-view");return Object(c["openBlock"])(),Object(c["createBlock"])(s)}var In=Object(c["defineComponent"])({name:"AppLayout"});In.render=Bn;var An=In,Dn=Object(c["withScopeId"])("data-v-127bea5a");Object(c["pushScopeId"])("data-v-127bea5a");var Rn={class:"relative h-full w-full grid md:customgrid"},Mn={class:"hidden w-full h-full md:grid place-items-center"},En={class:"flex flex-col mb-12 text-center"},Tn=Object(c["createVNode"])("p",null,"Select a chat",-1);Object(c["popScopeId"])();var Un=Dn((function(e,t,n,a,o,r){var s=Object(c["resolveComponent"])("ChatList"),l=Object(c["resolveComponent"])("app-layout");return Object(c["openBlock"])(),Object(c["createBlock"])(l,null,{default:Dn((function(){return[Object(c["createVNode"])("div",Rn,[Object(c["createVNode"])(s,{modelValue:e.showAddUserDialog,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.showAddUserDialog=t})},null,8,["modelValue"]),Object(c["createVNode"])("div",Mn,[Object(c["createVNode"])("div",En,[Tn,Object(c["createVNode"])("button",{onClick:t[2]||(t[2]=function(t){return e.showAddUserDialog=!0}),class:"mt-2 border rounded-full py-1 px-3"}," Or start a new conversation ")])])])]})),_:1})})),Ln=Object(c["withScopeId"])("data-v-34659be8");Object(c["pushScopeId"])("data-v-34659be8");var Fn={class:"relative w-full pt-4 justify-center"},Gn={class:"chatcard cursor-pointer flex flex-row items-center flex-row collapsed-bar:flex-col-reverse justify-center collapsed-bar:mb-0 mb-2"},qn={class:"flex-1 collapsed-bar:mb-2 flex flex-row items-center"},Wn=Object(c["createVNode"])("i",{class:"fas fa-plus"},null,-1),Pn=Object(c["createVNode"])("h1",{class:"collapsed-bar:hidden pt-1"},"Messages",-1),Yn={class:"ml-auto collapsed-bar:m-0 collapsed-bar:mb-2 hidden md:block relative"},_n={key:0,class:"h-full flex items-center justify-center"},Jn=Object(c["createVNode"])("i",{class:"fas fa-chevron-right"},null,-1),zn={key:1,class:"h-full flex items-center justify-center"},Hn=Object(c["createVNode"])("i",{class:"fas fa-chevron-left"},null,-1),Qn={key:0,class:"hidden collapsed-bar:block absolute -top-1 right-1 bg-accent h-4 w-4 rounded-full text-xs z-10 align-middle text-center text-white"},Zn={key:0,class:"collapsed-bar:hidden p-2"},Kn={style:{"font-size":"1.5em"}},Xn=Object(c["createTextVNode"])(" You have "),$n={style:{}},ec=Object(c["createTextVNode"])(" new connection request"),tc={key:0},nc={key:1,class:"relative overflow-y-auto w-full max-h-full h-full flex flex-col justify-center items-center px-2 collapsed-bar:px-0"},cc={key:0,class:"text-center collapsed-bar:hidden"},ac=Object(c["createVNode"])("p",null,"It feels lonely over here :(",-1),oc=Object(c["createVNode"])("h1",null,"Create a new chat",-1);Object(c["popScopeId"])();var rc=Ln((function(e,t,n,a,o,r){var s=Object(c["resolveComponent"])("ChatRequestList"),l=Object(c["resolveComponent"])("ChatCard"),i=Object(c["resolveComponent"])("add-contact"),u=Object(c["resolveComponent"])("jdialog");return Object(c["openBlock"])(),Object(c["createBlock"])("section",{class:["h-full bg-white w-full",{"collapsed-bar":e.collapsed,"md:w-16":e.collapsed,"md:w-400p":!e.collapsed}]},[Object(c["createVNode"])("div",Fn,[Object(c["createVNode"])("div",Gn,[Object(c["createVNode"])("div",qn,[Object(c["createVNode"])("button",{onClick:t[1]||(t[1]=function(t){return e.showAddUserDialog=!0}),class:"bg-icon rounded-full text-white w-8 h-8 collapsed-bar:w-10 collapsed-bar:h-10"},[Wn]),Pn]),Object(c["createVNode"])("div",Yn,[Object(c["createVNode"])("button",{class:"rounded-full w-8 h-8 collapsed-bar:w-10 collapsed-bar:h-10 bg-gray-100 flex justify-center",onClick:t[2]||(t[2]=function(t){return e.collapsed=!e.collapsed})},[e.collapsed?(Object(c["openBlock"])(),Object(c["createBlock"])("div",_n,[Jn])):(Object(c["openBlock"])(),Object(c["createBlock"])("div",zn,[Hn]))]),e.filteredChatRequests.length>0?(Object(c["openBlock"])(),Object(c["createBlock"])("div",Qn,Object(c["toDisplayString"])(e.filteredChatRequests.length),1)):Object(c["createCommentVNode"])("",!0)])]),e.filteredChatRequests.length>0?(Object(c["openBlock"])(),Object(c["createBlock"])("div",Zn,[Object(c["createVNode"])("h2",Kn,[Xn,Object(c["createVNode"])("span",$n,Object(c["toDisplayString"])(e.filteredChatRequests.length),1),ec,e.filteredChatRequests.length>1?(Object(c["openBlock"])(),Object(c["createBlock"])("span",tc,"s")):Object(c["createCommentVNode"])("",!0)]),Object(c["createVNode"])(s,{"chat-requests":e.filteredChatRequests},null,8,["chat-requests"])])):Object(c["createCommentVNode"])("",!0),e.filteredChats&&e.filteredChats.length?(Object(c["openBlock"])(),Object(c["createBlock"])("div",nc,[(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(e.filteredChats,(function(t){return Object(c["openBlock"])(),Object(c["createBlock"])(l,{key:"".concat(t.chatId,"-").concat(t.messages.length,"-").concat(t.read[e.user.id]),class:"w-full rounded-lg collapsed-bar:rounded-none p-2 collapsed-bar:my-0 my-2 cursor-pointer",onClick:function(n){return e.setSelected(t.chatId)},collapsed:e.collapsed,chat:t},null,8,["onClick","collapsed","chat"])})),128))])):Object(c["createCommentVNode"])("",!0)]),0==e.filteredChatRequests.length&&0==e.filteredChats.length?(Object(c["openBlock"])(),Object(c["createBlock"])("div",cc,[ac,Object(c["createVNode"])("button",{onClick:t[3]||(t[3]=function(t){return e.sendUpdate(!0)}),class:"mt-2 border rounded-full px-4"}," Add a contact ")])):Object(c["createCommentVNode"])("",!0),Object(c["createVNode"])(u,{modelValue:e.showAddUserDialog,"onUpdate:modelValue":e.sendUpdate,noActions:""},{title:Ln((function(){return[oc]})),default:Ln((function(){return[Object(c["createVNode"])(i,{onCloseDialog:t[4]||(t[4]=function(t){return e.sendUpdate(!1)})})]})),_:1},8,["modelValue","onUpdate:modelValue"])],2)})),sc=Object(c["withScopeId"])("data-v-2074b94a");Object(c["pushScopeId"])("data-v-2074b94a");var lc={class:"place-items-start"},ic={class:"grid grid-cols-2"},uc={class:"flex place-items-center"},dc=Object(c["createVNode"])("label",{class:"mr-2",for:"username"},"Username:",-1),pc={class:"flex place-items-center"},fc=Object(c["createVNode"])("label",{class:"mr-2",for:"location"},"Location:",-1),bc={class:"flex mt-4 justify-end w-full"},mc=Object(c["createVNode"])("button",null,"Add contact",-1),vc={class:"flex place-items-center"},Oc=Object(c["createVNode"])("label",{class:"mr-2",for:"username"},"Group name: ",-1),jc={class:"w-full"},gc=Object(c["createVNode"])("br",null,null,-1),hc={key:0,class:"text-red-600"},kc={class:"flex flex-col max-h-52 relative overflow-auto my-2 bg-gray-100 px-4 py-2 rounded-xl"},wc={class:"h-full"},yc={key:0},xc=Object(c["createVNode"])("p",{class:"text-gray-300 text-center py-4"}," No users in group yet ",-1),Vc={class:"col-span-2 place-items-center grid"},Nc={class:"col-span-8 pl-4 flex flex-col justify-center"},Cc={class:"col-span-2 place-items-center grid"},Sc=Object(c["createVNode"])("i",{class:"fas fa-times"},null,-1),Bc=Object(c["createVNode"])("i",{class:"fas fa-plus"},null,-1),Ic={class:"flex mt-4 justify-end w-full"},Ac=Object(c["createVNode"])("button",null,"Add Group",-1);Object(c["popScopeId"])();var Dc=sc((function(e,t){var n=Object(c["resolveComponent"])("auto-complete"),a=Object(c["resolveComponent"])("AvatarImg");return Object(c["openBlock"])(),Object(c["createBlock"])("div",lc,[Object(c["createVNode"])("div",ic,[Object(c["createVNode"])("a",{class:["nav-link grid-cols-6 text-center py-2",{active:e.isActive("user")}],onClick:t[1]||(t[1]=Object(c["withModifiers"])((function(t){return e.setActive("user")}),["prevent"])),href:"#"}," Add a user ",2),Object(c["createVNode"])("a",{class:["nav-link grid-cols-6 text-center py-2",{active:e.isActive("group")}],onClick:t[2]||(t[2]=Object(c["withModifiers"])((function(t){return e.setActive("group")}),["prevent"])),href:"#"}," Create a group ",2)]),e.isActive("user")?(Object(c["openBlock"])(),Object(c["createBlock"])("form",{key:0,onSubmit:t[6]||(t[6]=Object(c["withModifiers"])((function(){return e.contactAdd&&e.contactAdd.apply(e,arguments)}),["prevent"])),class:"w-full"},[Object(c["createVNode"])("div",uc,[dc,Object(c["createVNode"])(n,{data:e.possibleUsers,modelValue:e.usernameAdd,"onUpdate:modelValue":t[3]||(t[3]=function(t){return e.usernameAdd=t}),placeholder:"Search for user...",error:e.usernameAddError,onClicked:e.handleClicked},null,8,["data","modelValue","error","onClicked"])]),Object(c["createVNode"])("div",pc,[fc,Object(c["withDirectives"])(Object(c["createVNode"])("input",{id:"location","onUpdate:modelValue":t[4]||(t[4]=function(t){return e.userAddLocation=t}),class:"mb-2"},null,512),[[c["vModelText"],e.userAddLocation]])]),Object(c["createVNode"])("div",bc,[Object(c["createVNode"])("button",{type:"button",onClick:t[5]||(t[5]=function(t){return e.$emit("closeDialog")})}," Cancel "),mc])],32)):Object(c["createCommentVNode"])("",!0),e.isActive("group")?(Object(c["openBlock"])(),Object(c["createBlock"])("form",{key:1,onSubmit:t[9]||(t[9]=Object(c["withModifiers"])((function(){return e.groupAdd&&e.groupAdd.apply(e,arguments)}),["prevent"])),class:"w-full"},[Object(c["createVNode"])("div",vc,[Oc,Object(c["createVNode"])("div",jc,[Object(c["withDirectives"])(Object(c["createVNode"])("input",{"onUpdate:modelValue":t[7]||(t[7]=function(t){return e.groupnameAdd=t}),id:"username",class:"mb-2",placeholder:"Group name"},null,512),[[c["vModelText"],e.groupnameAdd]]),gc,""!=e.groupnameAddError?(Object(c["openBlock"])(),Object(c["createBlock"])("span",hc,Object(c["toDisplayString"])(e.groupnameAddError),1)):Object(c["createCommentVNode"])("",!0)])]),Object(c["createVNode"])("div",kc,[Object(c["createVNode"])("div",wc,[e.contacts.length?Object(c["createCommentVNode"])("",!0):(Object(c["openBlock"])(),Object(c["createBlock"])("div",yc,[xc])),(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(e.contacts,(function(t,n){return Object(c["openBlock"])(),Object(c["createBlock"])("div",{key:n,class:"grid grid-cols-12 rounded-lg mb-2 py-2"},[Object(c["createVNode"])("div",Vc,[Object(c["createVNode"])(a,{id:t.id,alt:"contact image"},null,8,["id"])]),Object(c["createVNode"])("div",Nc,Object(c["toDisplayString"])(t.id),1),Object(c["createVNode"])("div",Cc,[e.userIsInGroup(t)?(Object(c["openBlock"])(),Object(c["createBlock"])("button",{key:0,class:"h-12 rounded-full",onClick:function(n){return e.removeUserFromGroup(t)}},[Sc],8,["onClick"])):Object(c["createCommentVNode"])("",!0),e.userIsInGroup(t)?Object(c["createCommentVNode"])("",!0):(Object(c["openBlock"])(),Object(c["createBlock"])("button",{key:1,class:"h-12 rounded-full",onClick:function(n){return e.usersInGroup.push(t)}},[Bc],8,["onClick"]))])])})),128))])]),Object(c["createVNode"])("div",Ic,[Object(c["createVNode"])("button",{onClick:t[8]||(t[8]=function(t){return e.$emit("closeDialog")})},"Cancel"),Ac])],32)):Object(c["createCommentVNode"])("",!0)])})),Rc=Object(c["withScopeId"])("data-v-c8bcf260");Object(c["pushScopeId"])("data-v-c8bcf260");var Mc={key:0,class:"text-red-600"},Ec={class:"py-1"},Tc=Object(c["createTextVNode"])(),Uc=Object(c["createVNode"])("br",null,null,-1),Lc={class:"truncate"},Fc={key:0,class:"px-3 py-2 text-center"};Object(c["popScopeId"])();var Gc=Rc((function(e,t,n,a,o,r){return Object(c["openBlock"])(),Object(c["createBlock"])("div",{class:"relative w-full",onKeydown:t[6]||(t[6]=Object(c["withKeys"])((function(t){return e.showOptions=!1}),["esc"]))},[Object(c["withDirectives"])(Object(c["createVNode"])("input",{"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.searchTerm=t}),onInput:t[2]||(t[2]=function(){return e.handleInput&&e.handleInput.apply(e,arguments)}),placeholder:e.placeholder,ref:"input",tabindex:"0"},null,40,["placeholder"]),[[c["vModelText"],e.searchTerm]]),""!=e.error?(Object(c["openBlock"])(),Object(c["createBlock"])("span",Mc,Object(c["toDisplayString"])(e.error),1)):Object(c["createCommentVNode"])("",!0),e.modelValue?(Object(c["openBlock"])(),Object(c["createBlock"])("span",{key:1,onClick:t[3]||(t[3]=Object(c["withModifiers"])((function(t){return e.reset()}),["prevent"])),class:"absolute inset-y-0 right-0 pr-3 flex items-center cursor-pointer"}," x ")):Object(c["createCommentVNode"])("",!0),Object(c["withDirectives"])(Object(c["createVNode"])("div",{onClick:t[4]||(t[4]=Object(c["withModifiers"])((function(t){return e.handleSelf()}),["self"])),onFocusout:t[5]||(t[5]=function(t){return e.showOptions=!1}),tabindex:"0",class:e.dropdownClass},[Object(c["createVNode"])("ul",Ec,[(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(e.searchResults(),(function(t,n){return Object(c["openBlock"])(),Object(c["createBlock"])("li",{key:n,onClick:function(n){return e.handleClick(t)},class:"px-3 py-2 cursor-pointer hover:bg-gray-200 capitalize"},[Object(c["createVNode"])("b",null,Object(c["toDisplayString"])(t.id),1),Tc,Uc,Object(c["createVNode"])("span",Lc,Object(c["toDisplayString"])(t.location),1)],8,["onClick"])})),128)),e.searchResults().length?Object(c["createCommentVNode"])("",!0):(Object(c["openBlock"])(),Object(c["createBlock"])("li",Fc," No Matching Results "))])],34),[[c["vShow"],e.showOptions]])],32)})),qc=Object(c["defineComponent"])({props:{modelValue:{type:String,required:!1},placeholder:{type:String,required:!1,default:"Enter text here."},data:{type:Array,required:!0},dropdownClass:{type:String,required:!1,default:"absolute w-full z-50 bg-white border border-gray-300 mt-1 mh-48 overflow-hidden overflow-y-scroll rounded-md shadow-md"},error:{type:String,default:""}},emits:["update:modelValue","clicked"],setup:function(e,t){var n=t.emit,a=Object(c["ref"])(!1),o=Object(c["ref"])(""),r=Object(c["ref"])(""),s=function(){n("update:modelValue",""),o.value="",r.value=""},l=function(e){n("update:modelValue",e.target.value),a.value=!0},i=function(e){console.log(o.value),o.value=e.id,r.value=e.id,n("update:modelValue",e.id),a.value=!1,n("clicked")},u=function(){a.value=!1,o.value||n("update:modelValue","")},d=function(){return e.data.filter((function(e){return e.id.toLowerCase().includes(r.value.toLowerCase())}))};return{reset:s,handleInput:l,handleClick:i,clickedOutside:u,showOptions:a,chosenOption:o,searchTerm:r,searchResults:d}}});n("3d02");qc.render=Gc,qc.__scopeId="data-v-c8bcf260";var Wc=qc,Pc=Object(c["defineComponent"])({name:"ContactAdd",components:{AvatarImg:oe,autoComplete:Wc},emits:["closeDialog"],setup:function(e,t){var n=t.emit,a=Ct(),o=a.contacts,r=Object(c["ref"])(!1),l=Object(c["ref"])(""),i=Object(c["ref"])(""),u=Object(c["ref"])(""),d=Object(c["ref"])(""),p=Object(c["ref"])(""),f=Object(c["ref"])(""),b=Object(c["ref"])([]),m=Object(c["ref"])([]),v=Object(c["ref"])(""),O=function(){try{var e=l.value;m.value.find((function(t){return t.id===e}))||(u.value="Not able to find DigitalTwin of this user");var t=wt(),c=t.chats;if(c.value.filter((function(e){return!e.isGroup})).find((function(t){return t.chatId==e})))return void(u.value="Already added this user");var a=St(),o=a.addContact;o(e,i.value),console.log(e),l.value="",v.value="",n("closeDialog"),setTimeout((function(){He.value=e}),1e3)}catch(r){console.log("adding contact failed"),v.value=r}},j=function(){var e=m.value.find((function(e){return e.id==l.value}));e&&(i.value=e.location)},g=Object(c["ref"])("user"),h=function(e){return g.value===e},k=function(e){g.value=e,p.value="",u.value=""},w=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,c,a,o,r,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=yt(),c=t.addGroupchat,a=K(),o=a.user,r=wt(),r.chats,""!=d.value){e.next=6;break}return p.value="Please enter a group name",e.abrupt("return");case 6:if(!(d.value.length>20)){e.next=9;break}return p.value="The name can't contain more than 20 characters",e.abrupt("return");case 9:return e.next=11,Z();case 11:s=e.sent,b.value.push({id:o.id,location:s}),c(d.value,b.value),setTimeout((function(){He.value=d.value}),1e3),b.value=[],n("closeDialog");case 17:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=function(e){var t=b.value.find((function(t){return t.id==e.id}));return!!t},x=function(e){var t=b.value.findIndex((function(t){return t.id==e.id}));b.value.splice(t,1)};return _.a.get("".concat(Te.spawnerUrl,"api/v1/list"),{}).then((function(e){var t=K(),n=t.user,c=e.data;m.value=c.filter((function(e){return e.id!==n.id}))})),{addGroup:r,usernameAdd:l,usernameAddError:u,groupnameAdd:d,groupnameAddError:p,usernameInGroupAdd:f,userAddLocation:i,contactAdd:O,usersInGroup:b,isActive:h,setActive:k,groupAdd:w,contacts:o,userIsInGroup:y,removeUserFromGroup:x,possibleUsers:m,handleClicked:j}}});n("b1c5");Pc.render=Dc,Pc.__scopeId="data-v-2074b94a";var Yc=Pc,_c={class:"flex flex-row items-center w-full rounded-lg mb-2 py-2 align-middle"},Jc={key:0,class:"truncate flex-1"},zc={key:1,class:"truncate flex-1"},Hc=Object(c["createTextVNode"])(" wants to have a chat "),Qc=Object(c["createTextVNode"])(" ACCEPT ");function Zc(e,t,n,a,o,r){var s=Object(c["resolveComponent"])("Button");return Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(n.chatRequests,(function(e,t){return Object(c["openBlock"])(),Object(c["createBlock"])("div",{key:t},[Object(c["createVNode"])("div",_c,[e.isGroup?(Object(c["openBlock"])(),Object(c["createBlock"])("span",Jc,Object(c["toDisplayString"])(e.admin)+" invited you to "+Object(c["toDisplayString"])(e.name),1)):(Object(c["openBlock"])(),Object(c["createBlock"])("span",zc,[Object(c["createVNode"])("b",null,Object(c["toDisplayString"])(e.name),1),Hc])),Object(c["createVNode"])(s,{class:"self-end",onClick:function(t){return a.acceptChatRequest(e.chatId)}},{default:Object(c["withCtx"])((function(){return[Qc]})),_:2},1032,["onClick"])])])})),128)}var Kc={name:"ChatRequestList",components:{Button:on},props:{chatRequests:{}},setup:function(){var e=function(e){var t=yt(),n=t.acceptChat;n(e)};return{acceptChatRequest:e}}};Kc.render=Zc;var Xc=Kc,$c=Object(c["withScopeId"])("data-v-691ecbc6");Object(c["pushScopeId"])("data-v-691ecbc6");var ea={class:" place-items-center relative"},ta={key:0,class:"px-2 ml-2 content"},na={class:"flex"},ca={class:"font-bold break-normal overflow-ellipsis overflow-hidden name"},aa={key:0,class:"font-thin ml-2"},oa={key:1,class:"font-thin ml-auto"},ra={class:"col-end-13 col-span-2 font-thin truncate"};Object(c["popScopeId"])();var sa=$c((function(e,t){var n,a,o=Object(c["resolveComponent"])("AvatarImg");return Object(c["openBlock"])(),Object(c["createBlock"])("div",{class:["chatcard relative text-sm flex flex-row",{"bg-gray-50":!(null!==(n=e.router.currentRoute)&&void 0!==n&&n.value.path.includes(e.chat.chatId)),"bg-gray-200":null===(a=e.router.currentRoute)||void 0===a?void 0:a.value.path.includes(e.chat.chatId)}]},[Object(c["createVNode"])("div",ea,[Object(c["createVNode"])(o,{id:e.chat.chatId,showOnlineStatus:!e.chat.isGroup,unreadMessagesAmount:e.unreadMessagesAmount},null,8,["id","showOnlineStatus","unreadMessagesAmount"])]),e.collapsed?Object(c["createCommentVNode"])("",!0):(Object(c["openBlock"])(),Object(c["createBlock"])("div",ta,[Object(c["createVNode"])("p",na,[Object(c["createVNode"])("span",ca,Object(c["toDisplayString"])(e.chat.name),1),e.chat.isGroup?(Object(c["openBlock"])(),Object(c["createBlock"])("span",aa," (group)")):Object(c["createCommentVNode"])("",!0),e.lastMessage?(Object(c["openBlock"])(),Object(c["createBlock"])("span",oa,Object(c["toDisplayString"])(e.timeAgo(e.lastMessage.timeStamp)),1)):Object(c["createCommentVNode"])("",!0)]),Object(c["createVNode"])("p",ra,Object(c["toDisplayString"])(e.lastMessageBody),1)]))],2)})),la=Object(c["defineComponent"])({name:"ChatCard",components:{AvatarImg:oe},props:{chat:Object,collapsed:Boolean},setup:function(e){var t=K(),n=t.user,a=Object(c["computed"])((function(){var t=e.chat.read[n.id];return Object(Fe["findLastIndex"])(e.chat.messages,(function(e){return t===e.id}))})),o=Object(c["computed"])((function(){return e.chat&&e.chat.messages&&e.chat.messages.length?e.chat.messages[e.chat.messages.length-1]:"No messages yet"})),r=Object(c["computed"])((function(){return e.chat.messages.length-a.value-1})),s=function(e){return Re()(e).fromNow()},i=Object(c["computed"])((function(){return $[e.chat.chatId]})),u=Object(l["d"])(),d=Object(c["computed"])((function(){return u.currentRoute.value})),p=Object(c["computed"])((function(){var e=o.value;switch(e.type){case"GIF":return"Gif was sent";case"QUOTE":return e.body.message;case Se.SYSTEM:return e.body.message;case"FILE":return"File has been uploaded";case"DELETE":default:return e.body}})),f=Object(c["computed"])((function(){var t;if(!e.chat||!n)return 0;var c=e.chat.read[n.id],a=null===(t=e.chat.messages)||void 0===t?void 0:t.findIndex((function(e){return e.id===c}));return!a||a<1?0:e.chat.messages.length-(a+1)}));return{status:i,newMessages:r,lastReadByMe:a,lastMessage:o,lastMessageBody:p,timeAgo:s,router:u,user:n,currentRoute:d,unreadMessagesAmount:f}}});n("679b");la.render=sa,la.__scopeId="data-v-691ecbc6";var ia=la,ua=Object(c["defineComponent"])({name:"Apps",props:{modelValue:{type:Boolean,default:!1}},components:{addContact:Yc,jdialog:Zt,ChatCard:ia,AvatarImg:oe,ChatRequestList:Xc},emits:["closeDialog"],setup:function(e,t){var n=wt(),a=n.chats,o=n.chatRequests,r=yt(),s=r.retrievechats,i=Object(c["ref"])(!1),u=Object(c["ref"])(""),d=Object(c["computed"])((function(){return $[u.value]})),p=K(),f=p.user,b=function(e){return Re()(e)},m=Object(c["ref"])(""),v=Object(c["ref"])(!1),O=Object(l["d"])(),j=function(e){O.push({name:"single",params:{id:e}})},g=Object(c["computed"])((function(){return""==m.value?a.value:(console.log("filtered",a.value),a.value.filter((function(e){return e.name.toLowerCase().includes(m.value.toLowerCase())})))}));Object(c["onBeforeMount"])((function(){var e=qt(),t=e.initializeSocket;t(f.id.toString()),s()}));var h=Object(c["computed"])((function(){return a.value.find((function(e){return e.chatId==u.value}))}));ce(f);var k=Object(c["computed"])((function(){var e=o.value.filter((function(e){return!a.value.find((function(t){return t.chatId===e.chatId}))}));return Object(Fe["uniqBy"])(e,(function(e){return e.chatId}))})),w=function(e){console.log("update it"),re.value=e};return{status:d,selectedId:u,selectedChat:h,setSelected:j,chats:a,filteredChatRequests:k,searchValue:m,filteredChats:g,showContacts:v,user:f,collapsed:i,m:b,sendUpdate:w,showAddUserDialog:re}}});n("1cef");ua.render=rc,ua.__scopeId="data-v-34659be8";var da=ua,pa=Object(c["defineComponent"])({name:"Apps",components:{appLayout:yn,ChatList:da},setup:function(e,t){return Object(B["a"])(e),{showAddUserDialog:re}}});n("ec3b");pa.render=Un,pa.__scopeId="data-v-127bea5a";var fa=pa,ba=Object(c["withScopeId"])("data-v-0ee35422");Object(c["pushScopeId"])("data-v-0ee35422");var ma={key:0,class:"w-full flex md:px-4"},va={class:"place-items-center grid mr-4"},Oa={class:"py-4 pl-2"},ja={class:"font-bold font overflow-hidden overflow-ellipsis"},ga={key:0,class:"font-thin"},ha={key:1,class:"font-thin"},ka={key:1},wa={class:""},ya={class:"relative"},xa=Object(c["createVNode"])("i",{class:"fas fa-ellipsis-v"},null,-1),Va={key:1,class:"right-2 z-20 -top-2 flex flex-col bg-white shadow-sm w-40 rounded absolute py-2 pl-2"},Na=Object(c["createVNode"])("div",{class:"w-8 justify-center align-center"},[Object(c["createVNode"])("i",{class:"fas fa-video"})],-1),Ca=Object(c["createVNode"])("span",{class:"ml-1 text-left"},"Call",-1),Sa=Object(c["createVNode"])("button",{onClick:null,class:"flex"},[Object(c["createVNode"])("div",{class:"w-8"},[Object(c["createVNode"])("i",{class:"fas fa-info-circle"})]),Object(c["createVNode"])("span",{class:"ml-1 text-left"},"Info")],-1),Ba=Object(c["createVNode"])("div",{class:"w-8"},[Object(c["createVNode"])("i",{class:"fas fa-minus-circle"})],-1),Ia=Object(c["createVNode"])("span",{class:"ml-1 text-left"},"Block chat",-1),Aa=Object(c["createVNode"])("div",{class:"w-8"},[Object(c["createVNode"])("i",{class:"fas fa-trash"})],-1),Da=Object(c["createVNode"])("span",{class:"ml-1 text-left"},"Delete chat",-1),Ra={class:"flex flex-row relative h-full w-full"},Ma={class:"topbar h-14 bg-white flex-row border border-t-0 border-gray-100 hidden md:flex"},Ea={class:"py-2 pl-4 flex-1"},Ta={class:"font-bold font overflow-hidden overflow-ellipsis w-80"},Ua={class:"font-thin"},La={class:"h-full flex items-center self-end px-8  space-x-4"},Fa=Object(c["createVNode"])("i",{class:"fas fa-video fa-w-12"},null,-1),Ga=Object(c["createVNode"])("i",{class:"far fa-window-maximize transform fa-w-12 ",style:{"--tw-rotate":"90deg"}},null,-1),qa={id:"viewAnchor",ref:"viewAnchor",style:{height:"40vh",position:"absolute",bottom:"0",width:"50%","pointer-events":"none"}},Wa=Object(c["createVNode"])("h1",{class:"text-center"},"Blocking",-1),Pa=Object(c["createTextVNode"])(" Do you really want to block "),Ya=Object(c["createTextVNode"])("? "),_a={class:"grid grid-cols-2 mt-2"},Ja=Object(c["createVNode"])("h1",{class:"text-center"},"Deleting Conversation",-1),za=Object(c["createTextVNode"])(" Do you really want to delete the conversation with "),Ha=Object(c["createTextVNode"])("? "),Qa={class:"grid grid-cols-2 mt-2"},Za={key:1,class:"grid h-full w-full place-items-center"},Ka=Object(c["createVNode"])("h2",null,"Loading",-1),Xa={class:"absolute max-w-full w-full p-4 pt-8"},$a={class:"bg-white p-2 pb-6 w-full relative rounded-lg mb-4 mt-0 md:grid place-items-center grid-cols-1 md:px-4"},eo={class:"place-items-center grid relative"},to={class:"my-3 break-words text-center w-full overflow-y-auto max-h-28 text-xl"},no={key:0,class:"break-words w-full overflow-y-auto font-bold text-center text-gray-300"};Object(c["popScopeId"])();var co=ba((function(e,t){var n=Object(c["resolveComponent"])("AvatarImg"),a=Object(c["resolveComponent"])("ImagePreview"),o=Object(c["resolveComponent"])("ChatList"),r=Object(c["resolveComponent"])("MessageBox"),s=Object(c["resolveComponent"])("ChatInput"),l=Object(c["resolveComponent"])("jdialog"),i=Object(c["resolveComponent"])("group-management"),u=Object(c["resolveComponent"])("appLayout");return Object(c["openBlock"])(),Object(c["createBlock"])(u,null,{top:ba((function(){var t;return[e.chat?(Object(c["openBlock"])(),Object(c["createBlock"])("div",ma,[Object(c["createVNode"])("div",va,[Object(c["createVNode"])(n,{id:e.chat.chatId,showOnlineStatus:!1},null,8,["id"])]),Object(c["createVNode"])("div",Oa,[Object(c["createVNode"])("p",ja,Object(c["toDisplayString"])(e.chat.name),1),e.chat.isGroup?Object(c["createCommentVNode"])("",!0):(Object(c["openBlock"])(),Object(c["createBlock"])("p",ga,Object(c["toDisplayString"])(null!==(t=e.statusList[e.chat.chatId])&&void 0!==t&&t.isOnline?"Is online":"Is offline"),1)),e.chat.isGroup?(Object(c["openBlock"])(),Object(c["createBlock"])("p",ha,"Group chat")):Object(c["createCommentVNode"])("",!0)])])):(Object(c["openBlock"])(),Object(c["createBlock"])("div",ka,"Loading"))]})),actions:ba((function(){return[Object(c["createVNode"])("div",wa,[Object(c["createVNode"])("div",ya,[Object(c["createVNode"])("button",{class:"text-lg text-white md:hidden",onClick:t[1]||(t[1]=function(t){return e.showMenu=!0})},[xa]),e.showMenu?(Object(c["openBlock"])(),Object(c["createBlock"])("div",{key:0,class:"backdrop",onClick:t[2]||(t[2]=function(t){return e.showMenu=!1})})):Object(c["createCommentVNode"])("",!0),e.showMenu?(Object(c["openBlock"])(),Object(c["createBlock"])("div",Va,[Object(c["createVNode"])("button",{onClick:t[3]||(t[3]=function(){return e.popupMeeting&&e.popupMeeting.apply(e,arguments)}),class:"flex align-center"},[Na,Ca]),Sa,Object(c["createVNode"])("button",{onClick:t[4]||(t[4]=function(){return e.blockChat&&e.blockChat.apply(e,arguments)}),class:"flex"},[Ba,Ia]),Object(c["createVNode"])("button",{onClick:t[5]||(t[5]=function(){return e.deleteChat&&e.deleteChat.apply(e,arguments)}),class:"flex"},[Aa,Da])])):Object(c["createCommentVNode"])("",!0)])])]})),default:ba((function(){var u;return[Object(c["createVNode"])(a),Object(c["createVNode"])("div",Ra,[Object(c["createVNode"])(o,{class:"hidden md:inline-block"}),e.chat?(Object(c["openBlock"])(),Object(c["createBlock"])("div",{class:"relative h-full flex flex-col flex-1",key:e.chat.id+e.selectedId},[Object(c["createVNode"])("div",Ma,[Object(c["createVNode"])("div",Ea,[Object(c["createVNode"])("p",Ta,Object(c["toDisplayString"])(e.chat.name),1),Object(c["createVNode"])("p",Ua,Object(c["toDisplayString"])(e.getChatStatus),1)]),Object(c["createVNode"])("div",La,[Object(c["createVNode"])("button",{onClick:t[6]||(t[6]=function(){return e.popupMeeting&&e.popupMeeting.apply(e,arguments)}),class:"focus:outline-none hover:text-accent text-gray-500"},[Fa]),Object(c["createVNode"])("button",{onClick:t[7]||(t[7]=function(){return e.toggleSideBar&&e.toggleSideBar.apply(e,arguments)}),class:["focus:outline-none hover:text-accent",{"text-accent":e.showSideBar,"text-gray-500":!e.showSideBar}]},[Ga],2)])]),Object(c["createVNode"])(r,{chat:e.chat},{viewAnchor:ba((function(){return[Object(c["createVNode"])("div",qa,null,512)]})),_:1},8,["chat"]),Object(c["createVNode"])(s,{selectedid:e.chat.chatId,onMessageSend:t[8]||(t[8]=function(t){return e.scrollToBottom(!0)})},null,8,["selectedid"]),Object(c["createVNode"])(l,{modelValue:e.showDialog,"onUpdate:modelValue":t[11]||(t[11]=function(t){return e.showDialog=t}),noActions:"",class:"max-w-10"},{title:ba((function(){return[Wa]})),default:ba((function(){return[Object(c["createVNode"])("div",null,[Pa,Object(c["createVNode"])("b",null,Object(c["toDisplayString"])(e.chat.name),1),Ya]),Object(c["createVNode"])("div",_a,[Object(c["createVNode"])("button",{onClick:t[9]||(t[9]=function(){return e.doBlockChat&&e.doBlockChat.apply(e,arguments)}),class:"bg-red-500 p-2 text-white font-bold"}," YES "),Object(c["createVNode"])("button",{onClick:t[10]||(t[10]=function(t){return e.showDialog=!1}),class:"p-2"}," NO ")])]})),_:1},8,["modelValue"]),Object(c["createVNode"])(l,{modelValue:e.showDeleteDialog,"onUpdate:modelValue":t[14]||(t[14]=function(t){return e.showDeleteDialog=t}),noActions:"",class:"max-w-10"},{title:ba((function(){return[Ja]})),default:ba((function(){return[Object(c["createVNode"])("div",null,[za,Object(c["createVNode"])("b",null,Object(c["toDisplayString"])(e.chat.name),1),Ha]),Object(c["createVNode"])("div",Qa,[Object(c["createVNode"])("button",{onClick:t[12]||(t[12]=function(){return e.doDeleteChat&&e.doDeleteChat.apply(e,arguments)}),class:"bg-red-500 p-2 text-white font-bold"}," YES "),Object(c["createVNode"])("button",{onClick:t[13]||(t[13]=function(t){return e.showDeleteDialog=!1}),class:"p-2"}," NO ")])]})),_:1},8,["modelValue"])])):(Object(c["openBlock"])(),Object(c["createBlock"])("div",Za,[Ka])),e.chat?(Object(c["openBlock"])(),Object(c["createBlock"])("aside",{class:["hidden relative h-full flex-col overflow-y-auto md:w-400p",{"md:flex":e.showSideBar,"md:hidden":!e.showSideBar}],key:"aside"+e.chat.id+e.selectedId},[Object(c["createVNode"])("div",Xa,[Object(c["createVNode"])("div",$a,[Object(c["createVNode"])("div",eo,[Object(c["createVNode"])(n,{class:"-mt-7",id:e.chat.chatId,showOnlineStatus:!e.chat.isGroup},null,8,["id","showOnlineStatus"])]),Object(c["createVNode"])("h2",to,Object(c["toDisplayString"])(e.chat.name),1),e.chat.isGroup?Object(c["createCommentVNode"])("",!0):(Object(c["openBlock"])(),Object(c["createBlock"])("p",no,Object(c["toDisplayString"])((null===(u=e.status)||void 0===u?void 0:u.status)||"No status found"),1))]),Object(c["createVNode"])(i,{"group-chat":e.chat,onAppCall:e.popupMeeting,onAppBlock:e.blockChat,onAppDelete:e.deleteChat},null,8,["group-chat","onAppCall","onAppBlock","onAppDelete"])])],2)):Object(c["createCommentVNode"])("",!0)])]})),_:1})})),ao=(n("13d5"),function(e,t,n,c){var a=void 0!==window.screenLeft?window.screenLeft:window.screenX,o=void 0!==window.screenTop?window.screenTop:window.screenY,r=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,s=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,l=r/window.screen.availWidth,i=(r-n)/2/l+a,u=(s-c)/2/l+o,d=window.open(e,t,"\n      scrollbars=yes,\n      width=".concat(n/l,",\n      height=").concat(c/l,",\n      top=").concat(u,",\n      left=").concat(i,"\n      "));return d&&d.focus(),d}),oo=Object(c["withScopeId"])("data-v-dc6e5024");Object(c["pushScopeId"])("data-v-dc6e5024");var ro={class:"flex-1"},so={class:"flex flex-row flex-wrap"},lo={key:0,class:"p-4 pb-0 font-bold my-message:text-icon "},io={class:"msgcard flex justify-between"},uo={class:"h-9 flex items-center absolute right-1.5 -bottom-3 hidden my-message:block"},po={key:0,class:"fas fa-check-double text-accent"},fo={key:1,class:"fas fa-check text-gray-400"},bo=Object(c["createVNode"])("i",{class:"fa fa-pen"},null,-1),mo=Object(c["createVNode"])("span",{class:"text-gray-600 pl-2"},"Edit",-1),vo=Object(c["createVNode"])("i",{class:"fa fa-reply"},null,-1),Oo=Object(c["createVNode"])("span",{class:"text-gray-600 pl-2"}," Reply",-1),jo=Object(c["createVNode"])("i",{class:"fa fa-trash"},null,-1),go=Object(c["createVNode"])("span",{class:"text-gray-600 pl-2"},"Delete",-1),ho={class:"pr-4 text-gray-600 date inline-block text-xs"},ko={key:0,class:"flex flex-col mb-4 ml-4 border-l-2 pl-2"},wo=Object(c["createVNode"])("div",{class:"text-gray-400 self-start"}," Replies: ",-1),yo={class:"replymsg flex justify-between"},xo={style:{"margin-top":"auto"},class:"actions pb-4 pl-4 flex"},Vo=Object(c["createVNode"])("i",{class:"fa fa-trash"},null,-1),No=Object(c["createVNode"])("span",{class:"text-gray-600 pl-2"},"Delete",-1),Co={class:"pr-4 text-gray-600 date inline-block text-xs"},So={key:1};Object(c["popScopeId"])();var Bo=oo((function(e,t,n,a,o,r){var s,l=Object(c["resolveComponent"])("AvatarImg"),i=Object(c["resolveComponent"])("MessageContent"),u=Object(c["resolveComponent"])("Time");return e.message.type!==e.MessageTypes.SYSTEM?(Object(c["openBlock"])(),Object(c["createBlock"])("div",{key:0,class:["messageCard flex flex-row",{"mb-2":e.isLastMessage,"my-message":e.isMine}],onClick:t[4]||(t[4]=function(t){return e.selectedMessageId=e.message.id})},[Object(c["createVNode"])(l,{small:"",class:["mr-2 ",{"opacity-0":!e.isLastMessage}],id:e.message.from,showOnlineStatus:!1},null,8,["class","id"]),Object(c["createVNode"])("div",ro,[Object(c["createVNode"])("div",so,[Object(c["createVNode"])("div",{class:["flex flex-col rounded-md rounded-r-xl mb-1 bg-white shadow relative overflow-hidden my-message:bg-my",{"rounded-tl-xl":e.isFirstMessage,"rounded-bl-xl":e.isLastMessage}]},[e.isFirstMessage&&e.isGroup?(Object(c["openBlock"])(),Object(c["createBlock"])("header",lo,Object(c["toDisplayString"])(e.message.from),1)):Object(c["createCommentVNode"])("",!0),Object(c["createVNode"])("main",io,[Object(c["createVNode"])(i,{message:e.message,key:e.message.type},null,8,["message"])]),Object(c["createVNode"])("div",uo,[e.isread?(Object(c["openBlock"])(),Object(c["createBlock"])("i",po)):(Object(c["openBlock"])(),Object(c["createBlock"])("i",fo))])],2),Object(c["createVNode"])("div",{style:{"margin-top":"auto"},class:["actions pb-4 pl-4 md:hidden",{flex:e.selectedMessageId===e.message.id,hidden:e.selectedMessageId!==e.message.id}]},[e.message.type===e.MessageTypes.STRING||e.message.type===e.MessageTypes.QUOTE?(Object(c["openBlock"])(),Object(c["createBlock"])("span",{key:0,class:"reply text-xs pr-4 cursor-pointer hover:underline hidden my-message:inline",onClick:t[1]||(t[1]=function(t){return e.editMessage(e.message)})},[bo,mo])):Object(c["createCommentVNode"])("",!0),Object(c["createVNode"])("span",{class:"reply text-xs pr-4 cursor-pointer hover:underline",onClick:t[2]||(t[2]=function(t){return e.replyMessage(e.message)})},[vo,Oo]),"DELETE"!==e.message.type?(Object(c["openBlock"])(),Object(c["createBlock"])("span",{key:1,class:"delete text-xs pr-4 cursor-pointer hover:underline hidden my-message:inline",onClick:t[3]||(t[3]=function(t){return e.deleteMessage(e.message)})},[jo,go])):Object(c["createCommentVNode"])("",!0),Object(c["createVNode"])("div",ho,[Object(c["createVNode"])(u,{time:new Date(e.message.timeStamp)},null,8,["time"])])],2)]),(null===(s=e.message.replies)||void 0===s?void 0:s.length)>0?(Object(c["openBlock"])(),Object(c["createBlock"])("div",ko,[wo,(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(e.message.replies,(function(t){var n;return Object(c["openBlock"])(),Object(c["createBlock"])("div",{key:t.id,class:"card flex mb-1"},[Object(c["createVNode"])(l,{class:"mr-2",small:"",id:t.from,showOnlineStatus:!1},null,8,["id"]),Object(c["createVNode"])("div",{class:["flex rounded-xl overflow-hidden",{"bg-white":t.from!==e.user.id,"bg-my":t.from===e.user.id}]},[Object(c["createVNode"])("main",yo,[Object(c["createVNode"])(i,{message:t},null,8,["message"])])],2),Object(c["createVNode"])("div",xo,[t.from===(null===(n=e.user)||void 0===n?void 0:n.id)&&"Message has been deleted"!==t.body?(Object(c["openBlock"])(),Object(c["createBlock"])("span",{key:0,class:"reply text-xs pr-4 cursor-pointer hover:underline",onClick:function(n){return e.deleteReply(e.message,t)}},[Vo,No],8,["onClick"])):Object(c["createCommentVNode"])("",!0),Object(c["createVNode"])("div",Co,[Object(c["createVNode"])(u,{time:new Date(e.message.timeStamp)},null,8,["time"])])])])})),128))])):Object(c["createCommentVNode"])("",!0)])],2)):(Object(c["openBlock"])(),Object(c["createBlock"])("div",So,[Object(c["createVNode"])(i,{message:e.message},null,8,["message"])]))}));function Io(e,t,n,a,o,r){return Object(c["openBlock"])(),Object(c["createBlock"])(Object(c["resolveDynamicComponent"])(e.contentComponent),{message:e.message,preventRecursion:e.preventRecursion,type:e.contentComponent},null,8,["message","preventRecursion","type"])}function Ao(e,t,n,a,o,r){return Object(c["openBlock"])(),Object(c["createBlock"])("span",{class:" pt-2 pl-4 pb-2 pr-8 ",innerHTML:e.computedMessage},null,8,["innerHTML"])}n("466d");var Do=/((http|https):\/\/([a-zA-Z0-9.\/?=&\[\]:\_\-\;\%]+))/g,Ro=Object(c["defineComponent"])({name:"StringContent",props:{message:{type:Object,required:!0}},setup:function(e){var t=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},n=Object(c["computed"])((function(){var n=t("".concat(e.message.body)),c=n.match(Do);return null===c||(n=n.replace(Do,"<a class='hover:underline' href='$1' target='_BLANK'>$1</a>")),n}));return{computedMessage:n}}});Ro.render=Ao;var Mo=Ro,Eo=Object(c["createVNode"])("i",{class:"fas fa-video mr-3"},null,-1),To={class:"underline"},Uo=Object(c["createVNode"])("button",{class:"text-xs text bg-accent text-white px-4 py-2 m-0 rounded-full ml-6"},[Object(c["createVNode"])("i",{class:"fas fa-video mr-3"}),Object(c["createTextVNode"])(" JOIN ")],-1),Lo={key:1,class:"justify-around flex self-center mb-4"};function Fo(e,t){return"JOINED_VIDEOROOM"===e.message.body.type?(Object(c["openBlock"])(),Object(c["createBlock"])("div",{key:0,class:"cursor-pointer flex justify-center items-center mb-4",onClick:t[1]||(t[1]=function(){return e.joinVideo&&e.joinVideo.apply(e,arguments)})},[Object(c["createVNode"])("div",null,[Eo,Object(c["createVNode"])("i",To,Object(c["toDisplayString"])(e.message.body.message),1)]),Uo])):(Object(c["openBlock"])(),Object(c["createBlock"])("div",Lo,[Object(c["createVNode"])("u",null,[Object(c["createVNode"])("i",null,Object(c["toDisplayString"])(e.message.body.message),1)])]))}var Go=n("3452"),qo=Object(c["defineComponent"])({name:"SystemContent",props:{message:{type:Object,required:!0}},setup:function(e){var t=Object(l["c"])(),n=Object(c["ref"])(t.params.id),a=wt(),o=a.chats,r=yt(),s=r.sendMessage,i=K(),u=i.user,d=Object(c["computed"])((function(){return o.value.find((function(e){return e.chatId==n.value}))})),p=function(){var t,n=null!==(t=e.message.body.id)&&void 0!==t?t:Go["SHA1"](d.value.isGroup?d.value.chatId:d.value.contacts.map((function(e){return e.id})).sort().join("-")).toString();s(d.value.chatId,{type:Ce.JOINED_VIDEOROOM,message:"".concat(u.id," joined the video chat"),id:n},Se.SYSTEM);ao("/videoroom/".concat(n),"video room",800,550)};return{joinVideo:p}}});qo.render=Fo;var Wo=qo,Po=Object(c["createVNode"])("div",{class:"icon bg-gray-600 rounded-full h-12 w-12 flex items-center justify-center text-white my-message:bg-icon"},[Object(c["createVNode"])("i",{class:"fas fa-file "})],-1),Yo={class:"pt-2 my-message:text-icon"};function _o(e,t,n,a,o,r){return Object(c["openBlock"])(),Object(c["createBlock"])("a",{class:"p-4 pb-2 pr-8 bg-gray-200 my-message:bg-my",href:e.calcExternalResourceLink(e.message.body.url),download:""},[Po,Object(c["createVNode"])("div",Yo,Object(c["toDisplayString"])(e.message.body.filename),1)],8,["href"])}var Jo=Object(c["defineComponent"])({name:"FileContent",props:{message:{type:Object,required:!0}},setup:function(e){return{calcExternalResourceLink:X}}});Jo.render=_o;var zo=Jo;function Ho(e,t,n,a,o,r){return Object(c["openBlock"])(),Object(c["createBlock"])("audio",{controls:"",class:"max-w-full",src:e.calcExternalResourceLink(e.message.body.url),onLoad:t[1]||(t[1]=function(t){return e.$emit("scroll")})},null,40,["src"])}var Qo=Object(c["defineComponent"])({name:"AudioContent",props:{message:{type:Object,required:!0}},emits:["scroll"],setup:function(e){Object(c["computed"])((function(){}));return{calcExternalResourceLink:X}}});Qo.render=Ho;var Zo=Qo;function Ko(e,t,n,a,o,r){return Object(c["openBlock"])(),Object(c["createBlock"])("img",{width:"450",src:e.src,onLoad:t[1]||(t[1]=function(){return e.imageLoaded&&e.imageLoaded.apply(e,arguments)}),class:"cursor-pointer",onClick:t[2]||(t[2]=function(){return e.show&&e.show.apply(e,arguments)})},null,40,["src"])}var Xo=Object(c["ref"])(),$o=function(){return Object(c["readonly"])(Xo)},er=function(){tr(void 0)},tr=function(e){Xo.value=e},nr=Object(c["defineComponent"])({name:"ImageContent",props:{message:{type:Object,required:!0}},setup:function(e){var t=_e(),n=t.addScrollEvent,c=X(e.message.body.url),a=function(){n()},o=function(){tr(c)};return{imageLoaded:a,show:o,src:c}}});nr.render=Ko;var cr=nr,ar={class:"gif flex items-center justify-center"};function or(e,t,n,a,o,r){return Object(c["openBlock"])(),Object(c["createBlock"])("div",ar,[Object(c["createVNode"])("img",{class:"h-48 self-center block",src:e.message.body,alt:""},null,8,["src"])])}var rr=Object(c["defineComponent"])({name:"GifContent",props:{message:{type:Object,required:!0}},setup:function(e){return{}}});rr.render=or;var sr=rr,lr={key:0,class:"border-l-2 border-gray-400 my-message:border-icon "},ir={key:0,class:"pl-4 font-bold my-message:text-icon"},ur={class:"px-4 py-2 pr-8"};function dr(e,t,n,a,o,r){var s=Object(c["resolveComponent"])("MessageContent");return Object(c["openBlock"])(),Object(c["createBlock"])("div",null,[Object(c["createVNode"])("div",{class:["quote",{"pt-2 px-4 ":!e.preventRecursion}]},[e.preventRecursion?Object(c["createCommentVNode"])("",!0):(Object(c["openBlock"])(),Object(c["createBlock"])("div",lr,["SYSTEM"!==e.message.body.quotedMessage?(Object(c["openBlock"])(),Object(c["createBlock"])("div",ir,Object(c["toDisplayString"])(e.message.body.quotedMessage.from),1)):Object(c["createCommentVNode"])("",!0),Object(c["createVNode"])(s,{message:e.message.body.quotedMessage,preventRecursion:""},null,8,["message"])]))],2),Object(c["createVNode"])("div",ur,Object(c["toDisplayString"])(e.message.body.message),1)])}var pr=Object(c["defineComponent"])({name:"QuoteContent",components:{MessageContent:gr},props:{message:{type:Object,required:!0},preventRecursion:{type:Boolean,default:!1,required:!1}}});pr.render=dr;var fr=pr,br=function(e){return-1!==e.indexOf(".gif")||-1!==e.indexOf(".png")||-1!==e.indexOf(".jpg")||-1!==e.indexOf(".jpeg")},mr=function(e){return-1!==e.indexOf(".mp3")||-1!==e.indexOf(".WebM")},vr=function(e){switch(e.type){case Se.STRING:return"StringContent";case Se.GIF:return"GifContent";case Se.QUOTE:return"QuoteContent";case Se.SYSTEM:return"SystemContent";case Se.FILE:return br(e.body.filename)?"ImageContent":mr(e.body.filename)?"AudioContent":"FileContent";default:return"StringContent"}},Or=Object(c["defineComponent"])({name:"MessageContent",components:{StringContent:Mo,SystemContent:Wo,FileContent:zo,AudioContent:Zo,ImageContent:cr,GifContent:sr,QuoteContent:fr},props:{message:{type:Object,required:!0},preventRecursion:{type:Boolean,default:!1}},setup:function(e){return{contentComponent:vr(e.message)}}});Or.render=Io;var jr,gr=Or,hr=Object(c["ref"])((new Date).getTime()),kr=Object(c["ref"])((new Date).getTime()),wr=Object(c["ref"])((new Date).getTime());function yr(e,t,n,a,o,r){var s=Object(c["resolveComponent"])("TimeContent");return Object(c["openBlock"])(),Object(c["createBlock"])(s,{time:e.time,key:e.clockType===e.ClockType.HOURS?e.hourClock:e.clockType===e.ClockType.MINUTES?e.minuteClock:e.clock},null,8,["time"])}function xr(e,t,n,a,o,r){return Object(c["toDisplayString"])(e.timeString)}(function(e){e["SECONDS"]="SECONDS",e["MINUTES"]="MINUTES",e["HOURS"]="HOURS"})(jr||(jr={})),setInterval((function(){hr.value=(new Date).getTime()}),1e3),setInterval((function(){kr.value=(new Date).getTime()}),4e4),setInterval((function(){wr.value=(new Date).getTime()}),24e5);var Vr=Object(c["defineComponent"])({name:"TimeContent",props:{time:{type:Date}},setup:function(e){var t=Object(c["computed"])((function(){return Re()(e.time).fromNow()}));return{timeString:t}}});Vr.render=xr;var Nr=Vr,Cr=Object(c["defineComponent"])({name:"Time",components:{TimeContent:Nr},props:{time:{type:Date}},setup:function(e){var t=new Date,n=t.getTime()-e.time.getTime(),c=jr.HOURS;return n<3e5?c=jr.SECONDS:n<24e5&&(c=jr.MINUTES),{clock:hr,clockType:c,ClockType:jr,hourClock:wr,minuteClock:kr}}});Cr.render=yr;var Sr=Cr,Br=Object(c["defineComponent"])({name:"MessageCard",components:{Time:Sr,MessageContent:gr,AvatarImg:oe},props:{message:Object,chatId:String,isMine:Boolean,isGroup:Boolean,isreadbyme:Boolean,isread:Boolean,isFirstMessage:Boolean,isLastMessage:Boolean},setup:function(e){var t=K(),n=t.user,a=function(){console.log("toggleSendForwardMessage")},o=function(t){Xe(e.chatId),Object(c["nextTick"])((function(){Ke(e.chatId,t,Le.REPLY)}))},r=_e(),s=r.addScrollEvent;Object(c["onMounted"])((function(){s()}));var l=function(){var t=yt(),n=t.readMessage;n(e.chatId,e.message.id)};e.isreadbyme||l();var i=function(t){var n={id:t.id,from:t.from,to:t.to,body:"Message has been deleted",timeStamp:t.timeStamp,type:Se.DELETE,replies:[],subject:null};vt(e.chatId,n)},u=function(t,n){var c={id:n.id,from:n.from,to:n.to,body:"Message has been deleted",timeStamp:t.timeStamp,type:Se.DELETE,replies:[],subject:t.id};vt(e.chatId,c)},d=function(t){Xe(e.chatId),Object(c["nextTick"])((function(){Ke(e.chatId,t,Le.EDIT)}))};return{moment:Re.a,toggleSendForwardMessage:a,replyMessage:o,user:n,deleteMessage:i,deleteReply:u,editMessage:d,MessageTypes:Se,clock:hr,selectedMessageId:Qe}}});n("4284");Br.render=Bo,Br.__scopeId="data-v-dc6e5024";var Ir=Br,Ar=Object(c["withScopeId"])("data-v-3080ccae");Object(c["pushScopeId"])("data-v-3080ccae");var Dr={key:1,class:"flex justify-between m-2 p-4 bg-white rounded-xl"},Rr={class:"flex flex-row"},Mr={class:"text-accent mr-4 self-center"},Er={key:0,class:"fa fa-reply fa-2x"},Tr={key:1,class:"fa fa-pen fa-2x"},Ur={class:"replymsg"},Lr=Object(c["createVNode"])("i",{class:"fas fa-times"},null,-1),Fr=Object(c["createVNode"])("h2",null,"GIF",-1),Gr=Object(c["createVNode"])("i",{class:"fas fa-paperclip  transform",style:{"--tw-rotate":"-225deg"}},null,-1),qr=Object(c["createVNode"])("i",{class:"fas fa-microphone "},null,-1),Wr=Object(c["createVNode"])("i",{class:"fas fa-circle text-red-600"},null,-1),Pr=Object(c["createVNode"])("unicode-emoji-picker",null,null,-1),Yr={class:"flex flex-row flex-1"},_r={key:0,class:"fas fa-chevron-down "},Jr={key:1,class:"fas fa-chevron-up "},zr={key:0,class:"bg-indigo-100 inline-flex text-sm rounded flex-row h-8 pl-3 self-center mr-2"},Hr=Object(c["createVNode"])("div",{class:"self-center"},[Object(c["createVNode"])("i",{class:"fas fa-file"})],-1),Qr={class:"ml-2 mr-1 leading-relaxed truncate max-w- self-center hidden md:inline-block"},Zr=Object(c["createVNode"])("i",{class:"fas  fa-times"},null,-1),Kr={type:"text",ref:"message"},Xr=Object(c["createVNode"])("i",{class:"fas fa-paper-plane"},null,-1);Object(c["popScopeId"])();var $r=Ar((function(e,t){var n,a,o=Object(c["resolveComponent"])("GifSelector"),r=Object(c["resolveDirective"])("focus");return Object(c["openBlock"])(),Object(c["createBlock"])(c["Fragment"],null,[e.showGif?(Object(c["openBlock"])(),Object(c["createBlock"])(o,{key:0,onSendgif:e.sendGif,style:{"z-index":"10000"},onClose:e.hideGif},null,8,["onSendgif","onClose"])):Object(c["createCommentVNode"])("",!0),e.action?(Object(c["openBlock"])(),Object(c["createBlock"])("div",Dr,[Object(c["createVNode"])("div",Rr,[Object(c["createVNode"])("div",Mr,[(null===(n=e.action)||void 0===n?void 0:n.type)===e.MessageAction.REPLY?(Object(c["openBlock"])(),Object(c["createBlock"])("i",Er)):(null===(a=e.action)||void 0===a?void 0:a.type)===e.MessageAction.EDIT?(Object(c["openBlock"])(),Object(c["createBlock"])("i",Tr)):Object(c["createCommentVNode"])("",!0)]),Object(c["createVNode"])("div",Ur,[Object(c["createVNode"])("b",null,Object(c["toDisplayString"])(e.action.message.from),1),Object(c["createVNode"])("p",null,Object(c["toDisplayString"])(e.getActionMessage),1)])]),Object(c["createVNode"])("button",{onClick:t[1]||(t[1]=function(){return e.clearAction&&e.clearAction.apply(e,arguments)})},[Lr])])):Object(c["createCommentVNode"])("",!0),Object(c["createVNode"])("div",{class:"md:p-2 md:m-2 md:rounded-3xl bg-white flex flex-col actions md:flex-row",onPaste:t[12]||(t[12]=function(){return e.onPaste&&e.onPaste.apply(e,arguments)})},[Object(c["createVNode"])("div",{class:["md:col-span-4 flex flex-nowrap md:bg-transparent bg-gray-200",{hidden:!e.collapsed}]},[Object(c["createVNode"])("button",{class:"action-btn mx-2 my-0 p-0 self-center flex-1 pt-0.5",onClick:t[2]||(t[2]=function(){return e.toggleGif&&e.toggleGif.apply(e,arguments)})},[Fr]),Object(c["createVNode"])("button",{class:"action-btn mx-2 my-0 p-0 self-center flex-1",onClick:t[3]||(t[3]=Object(c["withModifiers"])((function(){return e.selectFile&&e.selectFile.apply(e,arguments)}),["stop"]))},[Gr]),Object(c["createVNode"])("input",{class:"hidden",type:"file",id:"fileinput",ref:"fileinput",onChange:t[4]||(t[4]=function(){return e.changeFile&&e.changeFile.apply(e,arguments)})},null,544),e.stopRecording?(Object(c["openBlock"])(),Object(c["createBlock"])("button",{key:1,class:"action-btn mx-2 my-0 p-0 self-center flex-1",onClick:t[6]||(t[6]=Object(c["withModifiers"])((function(){return e.stopRecording&&e.stopRecording.apply(e,arguments)}),["stop"]))},[Wr])):(Object(c["openBlock"])(),Object(c["createBlock"])("button",{key:0,class:"action-btn mx-2 my-0 p-0 self-center flex-1",onClick:t[5]||(t[5]=Object(c["withModifiers"])((function(){return e.startRecording&&e.startRecording.apply(e,arguments)}),["stop"]))},[qr])),Object(c["createVNode"])("span",{ref:"emojipicker",class:{hidden:!e.showEmoji},style:{position:"absolute",bottom:"75px","z-index":"10000"}},[Pr],2),e.file?Object(c["createCommentVNode"])("",!0):(Object(c["openBlock"])(),Object(c["createBlock"])("button",{key:2,class:"action-btn mx-2 my-0 p-0 self-center flex-1",onClick:t[7]||(t[7]=Object(c["withModifiers"])((function(){return e.toggleEmoji&&e.toggleEmoji.apply(e,arguments)}),["stop"]))}," 😃 "))],2),Object(c["createVNode"])("div",Yr,[(Object(c["openBlock"])(),Object(c["createBlock"])("button",{class:"action-btn mx-2 my-0 p-0 self-center md:hidden",onClick:t[8]||(t[8]=function(t){return e.collapsed=!e.collapsed}),key:e.collapsed.toString()},[e.collapsed?(Object(c["openBlock"])(),Object(c["createBlock"])("i",_r)):(Object(c["openBlock"])(),Object(c["createBlock"])("i",Jr))])),e.file?(Object(c["openBlock"])(),Object(c["createBlock"])("div",zr,[Hr,Object(c["createVNode"])("span",Qr,Object(c["toDisplayString"])(e.file.name),1),Object(c["createVNode"])("button",{class:"action-btn p-2 mx-0 self-center",onClick:t[9]||(t[9]=Object(c["withModifiers"])((function(){return e.removeFile&&e.removeFile.apply(e,arguments)}),["stop"]))},[Zr])])):Object(c["createCommentVNode"])("",!0),Object(c["createVNode"])("form",{class:"w-full",onSubmit:t[10]||(t[10]=Object(c["withModifiers"])((function(){return e.chatsend&&e.chatsend.apply(e,arguments)}),["prevent"]))},[Object(c["withDirectives"])(Object(c["createVNode"])("input",Kr,null,512),[[r]])],32),Object(c["createVNode"])("button",{class:"action-btn mx-2 my-0 p-0 self-center",onClick:t[11]||(t[11]=function(){return e.chatsend&&e.chatsend.apply(e,arguments)})},[Xr])])],32),Object(c["createVNode"])("div",{class:["overlay-emoji",{hidden:!e.showEmoji}],onClick:t[13]||(t[13]=function(){return e.hideEmoji&&e.hideEmoji.apply(e,arguments)}),style:{position:"fixed",width:"100vw",height:"100vh",background:"transparent",top:"0",left:"0","z-index":"9999"}},null,2),Object(c["createVNode"])("div",{class:["overlay-gif",{hidden:!e.showGif}],onClick:t[14]||(t[14]=function(){return e.hideGif&&e.hideGif.apply(e,arguments)}),style:{position:"fixed",width:"100vw",height:"100vh",background:"transparent",top:"0",left:"0","z-index":"9999"}},null,2)],64)})),es={class:"relative md:mx-4 px-4 bg-white rounded-t-xl",style:{height:"220px","overflow-y":"scroll"}},ts={class:"sticky top-0 bg-white flex py-4"},ns=Object(c["createVNode"])("i",{class:"fas fa-times"},null,-1),cs={class:"grid grid-cols-3 place-items-center bg-black"},as={key:0};function os(e,t,n,a,o,r){return Object(c["openBlock"])(),Object(c["createBlock"])("div",es,[Object(c["createVNode"])("div",ts,[Object(c["withDirectives"])(Object(c["createVNode"])("input",{type:"text",placeholder:"Search for gif...","onUpdate:modelValue":t[1]||(t[1]=function(e){return a.searchTerm=e})},null,512),[[c["vModelText"],a.searchTerm]]),Object(c["createVNode"])("button",{onClick:t[2]||(t[2]=function(t){return e.$emit("close")})},[ns])]),Object(c["createVNode"])("div",cs,[(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(a.gifs,(function(t){return Object(c["openBlock"])(),Object(c["createBlock"])("img",{class:"h-40 object-contain",src:t,key:t,alt:"",onClick:function(n){return e.$emit("sendgif",t)}},null,8,["src","onClick"])})),128))]),0===a.gifs.length?(Object(c["openBlock"])(),Object(c["createBlock"])("span",as,"no Gifs found")):Object(c["createCommentVNode"])("",!0)])}n("841c");var rs=n("b60e"),ss=new rs["GiphyFetch"](Te.giphyApiKey),ls=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?ss.search(e,{limit:10}):ss.trending({limit:10})},is={name:"GifSelector",emits:["close"],setup:function(e){var t=Object(c["ref"])([]),n=Object(c["ref"])("");return ls().then((function(e){t.value=e.data.map((function(e){return e.images.original.url}))})),Object(c["watch"])(n,(function(e){ls(e).then((function(e){t.value=e.data.map((function(e){return e.images.original.url}))}))})),{gifs:t,searchTerm:n}}};is.render=os;var us=is,ds=n("4aa0"),ps={name:"ChatInput",components:{GifSelector:us},emits:["messageSend"],props:{selectedid:{type:String}},setup:function(e,t){var n=t.emit;new ds["a"];var a=yt(),o=a.sendMessage,r=a.sendFile,l=Object(c["ref"])(null),i=(Object(c["ref"])(null),Object(c["ref"])()),u=Object(c["ref"])(null),d=Object(c["ref"])(),p=Object(c["ref"])(null),f=Object(c["ref"])(!1),b=_e(),m=b.addScrollEvent,v=Object(c["computed"])((function(){if(e.selectedid)return null===Ze||void 0===Ze?void 0:Ze.actions[e.selectedid]})),O=function(){Xe(e.selectedid)};Object(c["watch"])(v,(function(){v.value&&l.value&&(console.log("Selecting chat ..."),l.value.focus())}));var j=function(e){var t=e.message.body;switch(e.message.type){case Se.QUOTE:t.message=l.value.value;break;default:t=l.value.value;break}return t},g=function(){var t,n=K(),c=n.user;switch(null===v||void 0===v||null===(t=v.value)||void 0===t?void 0:t.type){case Le.REPLY:return{id:Ue(),from:c.id,to:e.selectedid,body:{message:l.value.value,quotedMessage:v.value.message},timeStamp:new Date,type:Se.QUOTE,replies:[],subject:null};case Le.EDIT:var a=j(v.value),o={id:v.value.message.id,from:c.id,to:e.selectedid,body:a,timeStamp:v.value.message.timeStamp,type:v.value.message.type,replies:v.value.message.replies,subject:null,updated:new Date},r={id:Ue(),from:c.id,to:e.selectedid,body:o,timeStamp:new Date,type:Se.EDIT,replies:[],subject:null};return console.log(r),r}return{id:Ue(),from:c.id,to:e.selectedid,body:l.value.value,timeStamp:new Date,type:"STRING",replies:[],subject:null}},h=function(){l.value.value=""},k=function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(c){var a,s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=yt(),s=a.sendMessageObject,console.log("mes",l.value.value),!v.value){t.next=10;break}return console.log("action",v.value),i=g(),s(e.selectedid,i),O(),h(),m(),t.abrupt("return");case 10:""!=l.value.value&&(o(e.selectedid,l.value.value),h()),u.value&&(r(e.selectedid,u.value),x()),n("messageSend"),f.value=!1;case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),w=function(){i.value.click()},y=function(){var e;u.value=null===(e=i.value)||void 0===e?void 0:e.files[0],l.value.focus()},x=function(){u.value=null},V=function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var n,c,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,navigator.mediaDevices.getUserMedia({audio:!0});case 2:n=t.sent,c=new MediaRecorder(n),a=[],c.addEventListener("dataavailable",(function(e){a.push(e.data)})),c.start(),p.value=function(){c.addEventListener("stop",Object(s["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=new Blob(a),console.log(e.selectedid),console.log(n),r(e.selectedid,n,!0),p.value=null;case 5:case"end":return t.stop()}}),t)})))),c.stop(),n.getAudioTracks().forEach((function(e){return e.stop()}))};case 8:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),N=function(){f.value=!f.value},C=function(){f&&(f.value=!1)},S=Object(c["ref"])(!1),B=function(){S.value=!S.value},I=function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(c){var a,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:S.value=!1,a=yt(),o=a.sendMessage,o(e.selectedid,c,"GIF"),n("messageSend"),m();case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),A=function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:S.value=!1;case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(c["nextTick"])((function(){var e=document.querySelector("unicode-emoji-picker");e.addEventListener("emoji-pick",(function(e){l.value.value="".concat(l.value.value).concat(e.detail.emoji),l.value.focus()}))}));var D=function(e){if(e.clipboardData){var t=e.clipboardData.items;if(t)for(var n=0;n<t.length;n++)if(-1!=t[n].type.indexOf("image")){var c=t[n].getAsFile();u.value=c,l.value.focus()}}},R=Object(c["computed"])((function(){return v.value.message.type===Se.QUOTE?v.value.message.body.message:v.value.message.body})),M=Object(c["ref"])(!0);return{sendMessage:o,message:l,chatsend:k,changeFile:y,selectFile:w,fileinput:i,file:u,removeFile:x,startRecording:V,stopRecording:p,showEmoji:f,toggleEmoji:N,hideEmoji:C,emojipicker:d,showGif:S,toggleGif:B,sendGif:I,hideGif:A,collapsed:M,onPaste:D,action:v,clearAction:O,getActionMessage:R,MessageAction:Le,MessageTypes:Se}}};n("04ce");ps.render=$r,ps.__scopeId="data-v-3080ccae";var fs=ps,bs=Object(c["withScopeId"])("data-v-46c6b3a9");Object(c["pushScopeId"])("data-v-46c6b3a9");var ms={key:0,class:"bg-white p-2 w-full relative rounded-lg mb-4 mt-0 md:grid place-items-center grid-cols-1"},vs=Object(c["createVNode"])("h2",null,"Members",-1),Os={class:"chatcard relative grid grid-cols-12 rounded-lg mb-2 py-2"},js={class:"md:col-span-2 col-span-2 place-items-center grid relative"},gs={class:"md:col-span-8 col-span-8 pl-2"},hs={class:"flex place-content-between"},ks={class:"font-bold overflow-hidden overflow-ellipsis"},ws={class:"btns col-span-2"},ys=Object(c["createVNode"])("i",{class:"fas fa-times text-red-500"},null,-1),xs={key:0,class:"flex flex-col max-h-52 relative overflow-auto my-2 bg-gray-100 px-4 py-2 rounded-xl"},Vs=Object(c["createVNode"])("h2",{class:"text-center"},"Add new members",-1),Ns={class:"h-full"},Cs={key:0},Ss=Object(c["createVNode"])("p",{class:"text-gray-300 text-center py-4"}," Not able to add any contacts to this group ",-1),Bs={class:"col-span-2 place-items-center grid"},Is={class:"col-span-8 pl-4 flex-col justify-center overflow-hidden overflow-ellipsis w-full"},As={class:"col-span-2 place-items-center grid"},Ds=Object(c["createVNode"])("i",{class:"fas fa-plus"},null,-1),Rs={class:"bg-white p-2 w-full relative rounded-lg mb-4 mt-0 md:grid place-items-center grid-cols-1"},Ms=Object(c["createVNode"])("h2",null,"Actions",-1),Es={class:"flex items-center flex-col w-full"},Ts=Object(c["createVNode"])("i",{class:"fas fa-video m-3"},null,-1),Us=Object(c["createVNode"])("p",{class:"m-3"},"Join video room",-1),Ls=Object(c["createVNode"])("i",{class:"fas fa-minus-circle m-3"},null,-1),Fs=Object(c["createVNode"])("p",{class:"m-3"},"Block user",-1),Gs=Object(c["createVNode"])("i",{class:"fas fa-trash m-3"},null,-1),qs=Object(c["createVNode"])("p",{class:"m-3"},"Delete conversation",-1);Object(c["popScopeId"])();var Ws=bs((function(e,t,n,a,o,r){var s=Object(c["resolveComponent"])("AvatarImg");return Object(c["openBlock"])(),Object(c["createBlock"])(c["Fragment"],null,[n.groupChat.isGroup?(Object(c["openBlock"])(),Object(c["createBlock"])("div",ms,[vs,(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(n.groupChat.contacts,(function(e){return Object(c["openBlock"])(),Object(c["createBlock"])("div",{key:e.id+n.groupChat.contacts.length,class:"w-full"},[Object(c["createVNode"])("div",Os,[Object(c["createVNode"])("div",js,[Object(c["createVNode"])(s,{small:"",id:e.id},null,8,["id"])]),Object(c["createVNode"])("div",gs,[Object(c["createVNode"])("p",hs,[Object(c["createVNode"])("span",ks,Object(c["toDisplayString"])(e.id),1)])]),Object(c["createVNode"])("div",ws,[a.iAmAdmin?(Object(c["openBlock"])(),Object(c["createBlock"])("button",{key:0,onClick:function(t){return a.removeFromGroup(e)}},[ys],8,["onClick"])):Object(c["createCommentVNode"])("",!0)])])])})),128)),a.iAmAdmin?(Object(c["openBlock"])(),Object(c["createBlock"])("div",xs,[Vs,Object(c["createVNode"])("div",Ns,[a.contacts.length?Object(c["createCommentVNode"])("",!0):(Object(c["openBlock"])(),Object(c["createBlock"])("div",Cs,[Ss])),(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(a.contacts,(function(e,t){return Object(c["openBlock"])(),Object(c["createBlock"])("div",{key:t,class:"grid grid-cols-12 rounded-lg mb-2 py-2"},[Object(c["createVNode"])("div",Bs,[Object(c["createVNode"])(s,{small:"",id:e.id},null,8,["id"])]),Object(c["createVNode"])("div",Is,Object(c["toDisplayString"])(e.id),1),Object(c["createVNode"])("div",As,[Object(c["createVNode"])("button",{class:"h-12 rounded-full",onClick:function(t){return a.addToGroup(e)}},[Ds],8,["onClick"])])])})),128))])])):Object(c["createCommentVNode"])("",!0)])):Object(c["createCommentVNode"])("",!0),Object(c["createVNode"])("div",Rs,[Ms,Object(c["createVNode"])("div",Es,[Object(c["createVNode"])("div",{class:"call bg-gray-100 flex items-center rounded-xl w-full m-2",onClick:t[1]||(t[1]=function(t){return e.$emit("app-call")})},[Ts,Us]),n.groupChat.isGroup?Object(c["createCommentVNode"])("",!0):(Object(c["openBlock"])(),Object(c["createBlock"])("div",{key:0,class:"block bg-gray-100 flex items-center rounded-xl w-full m-2",onClick:t[2]||(t[2]=function(t){return e.$emit("app-block")})},[Ls,Fs])),Object(c["createVNode"])("div",{class:"delete bg-gray-100 flex items-center rounded-xl w-full m-2",onClick:t[3]||(t[3]=function(t){return e.$emit("app-delete")})},[Gs,qs])])])],64)})),Ps={name:"GroupManagementBlock",props:{groupChat:{required:!0}},emits:["app-call","app-block","app-delete"],components:{AvatarImg:oe},setup:function(e){var t=Ct(),n=t.contacts,a=function(t){var n=yt(),c=n.updateContactsInGroup;c(e.groupChat.chatId,t,!0)},o=function(t){var n=yt(),c=n.updateContactsInGroup;c(e.groupChat.chatId,t,!1)},r=Object(c["computed"])((function(){return n.filter((function(t){return!e.groupChat.contacts.map((function(e){return e.id})).includes(t.id)}))})),s=Object(c["computed"])((function(){var t=K(),n=t.user;return e.groupChat.adminId==n.id}));return{status:$,removeFromGroup:a,contacts:r,addToGroup:o,iAmAdmin:s}}};n("9f33");Ps.render=Ws,Ps.__scopeId="data-v-46c6b3a9";var Ys=Ps,_s=n("3835"),Js=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{root:null,rootMargin:"0px"},a=Object(c["ref"])(0),o=Object(c["ref"])(!1),r=Object(c["ref"])(!1),s=function(){e.value&&t.observe(e.value)};Object(c["onMounted"])((function(){t=new IntersectionObserver((function(e){var t=Object(_s["a"])(e,1),n=t[0];if(a.value=n.intersectionRatio,n.intersectionRatio>0)return o.value=!0,void(r.value=n.intersectionRatio>=1);o.value=!1}),n),s()}));var l=function(){t&&e.value&&t.unobserve(e.value)};return Object(c["onUnmounted"])(l),{intersectionRatio:a,isIntersecting:o,isFullyInView:r,observe:s,unobserve:l}},zs=Object(c["ref"])(!1),Hs=function(){return Object(c["readonly"])(zs)},Qs=function(){zs.value=!zs.value},Zs=Object(c["withScopeId"])("data-v-44436712");Object(c["pushScopeId"])("data-v-44436712");var Ks={class:"absolute w-full mt-8 px-4"},Xs={key:0,class:"flex flex-col justify-center items-center w-full"},$s=Object(c["createVNode"])("span",null,"Loading more messages",-1),el={key:0,class:"grey--text text-sm text-center p-4"};Object(c["popScopeId"])();var tl=Zs((function(e,t){var n=Object(c["resolveComponent"])("Spinner"),a=Object(c["resolveComponent"])("MessageCard");return Object(c["openBlock"])(),Object(c["createBlock"])("div",{class:"flex-grow relative overflow-y-auto",ref:"messageBox",onScroll:t[1]||(t[1]=function(){return e.handleScroll&&e.handleScroll.apply(e,arguments)})},[Object(c["createVNode"])("div",Ks,[e.chatInfo.isLoading?(Object(c["openBlock"])(),Object(c["createBlock"])("div",Xs,[Object(c["createVNode"])(n),$s])):Object(c["createCommentVNode"])("",!0),(Object(c["openBlock"])(!0),Object(c["createBlock"])(c["Fragment"],null,Object(c["renderList"])(e.chat.messages,(function(t,n){return Object(c["openBlock"])(),Object(c["createBlock"])("div",null,[e.showDivider(e.chat,n)?(Object(c["openBlock"])(),Object(c["createBlock"])("div",el,Object(c["toDisplayString"])(e.moment(t.timeStamp).calendar()),1)):Object(c["createCommentVNode"])("",!0),Object(c["createVNode"])(a,{isread:n<=e.lastRead,isreadbyme:n<=e.lastReadByMe,message:t,chatId:e.chat.chatId,isGroup:e.chat.isGroup,isMine:t.from===e.user.id,isLastMessage:e.isLastMessage(e.chat,n),isFirstMessage:e.isFirstMessage(e.chat,n),key:"".concat(t.id,"-").concat(n<=e.lastRead)},null,8,["isread","isreadbyme","message","chatId","isGroup","isMine","isLastMessage","isFirstMessage"])])})),256)),Object(c["renderSlot"])(e.$slots,"viewAnchor")])],544)})),nl=n("15fd"),cl=n("a38e"),al=(n("07ac"),Object(c["ref"])(null)),ol=function(){var e;null===al||void 0===al||null===(e=al.value)||void 0===e||e.scrollTo(0,al.value.scrollHeight)},rl=function(e,t){if(t+1===e.messages.length)return!0;var n=e.messages[t],c=e.messages[t+1];return c.type===Se.SYSTEM||(!!ll(e,t+1)||n.from!==c.from)},sl=function(e,t){if(0===t)return!0;var n=e.messages[t],c=e.messages[t-1];return c.type===Se.SYSTEM||(!!ll(e,t)||n.from!==c.from)},ll=function(e,t){var n=e.messages[t],c=e.messages[t-1];if(!c)return!0;var a=Re()(n.timeStamp);return a.diff(c.timeStamp,"m")>5},il=Object(c["withScopeId"])("data-v-bb2f2f22"),ul=il((function(e,t,n,a,o,r){return Object(c["openBlock"])(),Object(c["createBlock"])("div",{class:["loader ease-linear rounded-full border-4 border-gray-200 h-8 w-8 inline-block",{"h-12 w-12 border-4":n.xlarge,"h-10 w-10":n.large,"h-6 w-6":n.small,"h-4 w-4 border-2":n.xsmall}]},null,2)})),dl={name:"Spinner",props:{xlarge:{required:!1,default:!1,type:Boolean},large:{required:!1,default:!1,type:Boolean},small:{required:!1,default:!1,type:Boolean},xsmall:{required:!1,default:!1,type:Boolean}}};n("72f0");dl.render=ul,dl.__scopeId="data-v-bb2f2f22";var pl=dl,fl={name:"MessageBox",components:{MessageCard:Ir,Spinner:pl},props:{chat:{}},setup:function(e){var t=yt(),n=t.getChatInfo,a=t.getNewMessages,o=Object(c["computed"])((function(){var t=p.id,n=e.chat.read,c=(n[t],Object(nl["a"])(n,[t].map(cl["a"]))),a=Object.values(c);return Object(Fe["findLastIndex"])(e.chat.messages,(function(e){return a.includes(e.id)}))})),r=Object(c["computed"])((function(){return Object(Fe["findLastIndex"])(e.chat.messages,(function(t){return e.chat.read[p.id]===t.id}))})),l=function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(n){var c,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:c=al.value,o=c.scrollHeight,c.scrollTop<100&&a(e.chat.chatId).then((function(e){e&&c.scrollTo({top:c.scrollHeight-o+c.scrollTop,behavior:"auto"})}));case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),i=_e(),u=i.addScrollEvent;Object(c["onMounted"])((function(){u(!0)}));var d=K(),p=d.user;return{isLastMessage:rl,isFirstMessage:sl,user:p,moment:Re.a,lastRead:o,lastReadByMe:r,showDivider:ll,messageBox:al,handleScroll:l,chatInfo:Object(c["computed"])((function(){return n(e.chat.chatId)}))}}};n("57d9");fl.render=tl,fl.__scopeId="data-v-44436712";var bl=fl,ml=(n("26e9"),Object(c["withScopeId"])("data-v-519d4542"));Object(c["pushScopeId"])("data-v-519d4542");var vl={class:"absolute w-full top-4 left-0 flex justify-end md:pr-8"},Ol=Object(c["createVNode"])("i",{class:"fas fa-download fa-2x"},null,-1),jl=Object(c["createVNode"])("i",{class:"fas fa-times fa-2x"},null,-1);Object(c["popScopeId"])();var gl=ml((function(e,t,n,a,o,r){return e.src?(Object(c["openBlock"])(),Object(c["createBlock"])("div",{key:0,id:"image-viewer",class:"fixed z-10 left-0 top-0 w-full h-full overflow-auto bg-black bg-opacity-90 flex",onClick:t[2]||(t[2]=function(){return e.close&&e.close.apply(e,arguments)})},[Object(c["createVNode"])("div",vl,[Object(c["createVNode"])("a",{class:"cursor-pointer text-gray-100 size hover:text-accent mr-4",href:e.src,download:e.src.split("/").reverse()[0]},[Ol],8,["href","download"]),Object(c["createVNode"])("button",{class:"cursor-pointer text-gray-100 size hover:text-gray-500",onClick:t[1]||(t[1]=function(){return e.close&&e.close.apply(e,arguments)})},[jl])]),Object(c["createVNode"])("img",{class:"modal-content m-auto block md:max-w-80p md:max-h-80p max-w-full max-w-full self-center",id:"full-image",src:e.src},null,8,["src"])])):Object(c["createCommentVNode"])("",!0)})),hl=Object(c["defineComponent"])({name:"ImagePreview",setup:function(){var e=function(){er()};return{close:e,src:$o()}}});n("5ba5");hl.render=gl,hl.__scopeId="data-v-519d4542";var kl=hl,wl=Object(c["defineComponent"])({name:"ChatView",components:{Button:on,MessageBox:bl,AvatarImg:oe,ChatInput:fs,MessageCard:Ir,jdialog:Zt,appLayout:yn,GroupManagement:Ys,ChatList:da,ImagePreview:kl},setup:function(e){var t=Object(l["c"])(),n=Object(c["ref"])(t.params.id);Object(c["watch"])((function(){return t.params.id}),(function(e){n.value=e}));var a=yt(),o=a.retrievechats;Object(c["onBeforeMount"])(o);var r=wt(),s=r.chats,i=yt(),u=i.sendMessage,d=K(),p=d.user,f=function(e){return Re()(e)},b=Object(c["ref"])(!1),m=Object(c["ref"])(),v=Object(l["d"])(),O=Object(c["ref"])(!1),j=Object(c["ref"])(!1),g=Object(c["toRefs"])(e),h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;return e.length>t&&(e=e.substring(0,t-3)+"..."),e},k=Object(c["computed"])((function(){var e=0;return y.value.messages.reduce((function(t,n){return t[e]&&t[e].user===n.from?(t[e].messages.push(n),t):(e++,t[e]={user:n.from,messages:[]},t[e].messages.push(n),t)}),{})})),w=Object(c["ref"])(""),y=Object(c["computed"])((function(){return s.value.find((function(e){return e.chatId==n.value}))})),x=Object(c["computed"])((function(){if(y.value){if(y.value.isGroup){var e="".concat(y.value.contacts.length," members"),t=y.value.contacts.filter((function(e){return e.id!=p.id})).map((function(e){var t,n;return Object(z["a"])(Object(z["a"])({},e),{},{isOnline:null!==(t=null===(n=$[e.id])||void 0===n?void 0:n.isOnline)&&void 0!==t&&t})})).length;return t>0&&(e+=", ".concat(t," online")),e}var n=$[y.value.chatId];return null!==n&&void 0!==n&&n.isOnline?"Online":"Offline"}})),V=function(){var e=y.value.isGroup?y.value.chatId:y.value.contacts.map((function(e){return e.id})).sort().join(),t=Go["SHA1"](e);u(y.value.chatId,{type:Ce.JOINED_VIDEOROOM,message:"".concat(p.id," joined the video chat"),id:t.toString()},Se.SYSTEM),ao("/videoroom/".concat(t),"video room",800,550)},N=function(){j.value=!0},C=function(){Lt(y.value.chatId),v.push({name:"chat"})},S=function(){O.value=!0},B=function(){O.value=!1,Ft(y.value.chatId),v.push({name:"chat"})},I=Object(c["computed"])((function(){var e={};return Object(Fe["each"])(y.value.read,(function(t,n){n!==p.id&&(e[t]=e[t]?[n].concat(Object(Ie["a"])(e[t])):[n])})),e})),A=Object(c["ref"])(null),D=Js(A),R=D.isIntersecting,M=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(e||R.value)&&Object(c["nextTick"])((function(){ol()}))};Object(c["onMounted"])((function(){Object(c["nextTick"])((function(){M(!0)}))}));var E=Object(c["computed"])((function(){return $[n.value]})),T=Ye(),U=T.scrollEvents,L=_e(),F=L.clearScrollEvents;return Object(c["watch"])(U,(function(){var e=U.find((function(e){return e}));Object(c["nextTick"])((function(){M(e),F()}))})),Object(z["a"])({chats:s,selectedId:n,chat:y,getMessagesSortedByUser:k,truncate:h,message:w,file:m,m:f,scrollToBottom:M,status:E,statusList:$,popupMeeting:V,deleteChat:N,doDeleteChat:C,blockChat:S,doBlockChat:B,viewAnchor:A,reads:I,showDialog:O,showDeleteDialog:j,showMenu:b,showSideBar:Hs(),toggleSideBar:Qs,getChatStatus:x,moment:Re.a},g)}});n("d574");wl.render=co,wl.__scopeId="data-v-0ee35422";var yl=wl,xl=Object(c["createVNode"])("h2",null,"Redirecting you to your digitaltwin.",-1);function Vl(e,t,n,a,o,r){return Object(c["openBlock"])(),Object(c["createBlock"])("div",null,[xl])}var Nl=Object(c["defineComponent"])({name:"Home",mounted:function(){var e=window.location.host.split(".")[0],t={name:e,image:"".concat(window.location.origin,"/api/user/avatar"),email:"".concat(e.replace(/ /g,""),"@domain.com")};localStorage.setItem("user",JSON.stringify(t));var n=Object(l["d"])();n.push("/chat")},setup:function(){}});Nl.render=Vl;var Cl=Nl,Sl=Object(c["createVNode"])("h2",null,"Unauthorised",-1),Bl=Object(c["createVNode"])("p",null,[Object(c["createTextVNode"])(" this is not your digital twin, please go to our "),Object(c["createVNode"])("a",{href:"https://digitaltwin.jimbertesting.be"},"homepage")],-1);function Il(e,t,n,a,o,r){return Object(c["openBlock"])(),Object(c["createBlock"])("div",null,[Sl,Bl])}var Al=Object(c["defineComponent"])({name:"Unauthorised"});Al.render=Il;var Dl=Al,Rl=[{path:"/",name:"Home",component:j},{path:"/callback",name:"Callback/:signedAttempt",component:Cl,meta:{requiresAuth:!0}},{path:"/unauthorized",name:"Unauthorized",component:Dl},{path:"/chat",component:An,children:[{path:"",name:"chat",component:fa,meta:{requiresAuth:!0}},{path:":id",name:"single",component:yl,meta:{back:"chat",requiresAuth:!0}}]},{name:"filebrowser",path:"/filebrowser",component:Vn,meta:{requiresAuth:!0}},{name:"videoroom",path:"/videoroom/:id",component:Sn}],Ml=Object(l["a"])({history:Object(l["b"])("/"),routes:Rl});Ml.beforeEach(function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t,n,c){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.t0=t.matched.some((function(e){return e.meta.requiresAuth})),!e.t0){e.next=5;break}return e.next=4,Xt();case 4:e.t0=!e.sent;case 5:if(!e.t0){e.next=7;break}c({name:"Home"});case 7:c();case 8:case"end":return e.stop()}}),e)})));return function(t,n,c){return e.apply(this,arguments)}}());var El=Ml,Tl=(n("7051"),n("8e27")),Ul={install:function(e,t){var n=t.connection,c=t.options,a=Object(Tl["io"])(n,c);e.config.globalProperties.$socket=a,e.provide("socket",a)}},Ll={beforeMount:function(e,t){e.clickOutsideEvent=function(n){e==n.target||e.contains(n.target)||t.value()},document.addEventListener("click",e.clickOutsideEvent)},unmounted:function(e){document.removeEventListener("click",e.clickOutsideEvent)}},Fl=Object(c["createApp"])(r).directive("click-outside",Ll).use(El).use(Ul,{connection:Te.baseUrl,options:{debug:!0},transports:["websocket"]});Fl.component("MessageContent",gr),Fl.directive("focus",{mounted:function(e){e.focus()}}),Fl.mount("#app");t["default"]=Fl},d574:function(e,t,n){"use strict";n("91c7")},d703:function(e,t,n){},d940:function(e,t,n){},da42:function(e,t,n){},e4b3:function(e,t,n){},e6e1:function(e,t,n){},ec3b:function(e,t,n){"use strict";n("7eb9")},ede6:function(e,t,n){"use strict";n("bafe")},eec3:function(e,t,n){},f6d5:function(e,t,n){"use strict";n("0f70")},ff34:function(e,t,n){}});
//# sourceMappingURL=app.f94ddf90.js.map